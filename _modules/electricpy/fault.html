
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>electricpy.fault &#8212; electricpy 0.2.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/material.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/ElectricpyLogo.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#_modules/electricpy/fault" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../index.html" title="electricpy 0.2.2 documentation"
           class="md-header-nav__button md-logo">
          
              <img src="../../_static/ElectricpyLogo.svg" height="26"
                   alt="electricpy 0.2.2 documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">ElectricPy</span>
          <span class="md-header-nav__topic"> electricpy.fault </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/engineerjoe440/ElectricPy/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ElectricPy
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">electricpy 0.2.2 documentation</a></li>
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Module code</a></li>
          <li class="md-tabs__item"><a href="../electricpy.html" class="md-tabs__link">electricpy</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="electricpy 0.2.2 documentation" class="md-nav__button md-logo">
      
        <img src="../../_static/ElectricpyLogo.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../index.html"
       title="electricpy 0.2.2 documentation">ElectricPy</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/engineerjoe440/ElectricPy/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ElectricPy
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../electricpyapi.html" class="md-nav__link">ElectricPy API</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../../api/electricpy.html" class="md-nav__link">electricpy</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../api/electricpy.bode.html" class="md-nav__link">electricpy.bode</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../api/electricpy.conversions.html" class="md-nav__link">electricpy.conversions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../api/electricpy.fault.html" class="md-nav__link">electricpy.fault</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../api/electricpy.latex.html" class="md-nav__link">electricpy.latex</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../api/electricpy.math.html" class="md-nav__link">electricpy.math</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../api/electricpy.passive.html" class="md-nav__link">electricpy.passive</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../api/electricpy.phasor.html" class="md-nav__link">electricpy.phasor</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../api/electricpy.sim.html" class="md-nav__link">electricpy.sim</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../api/electricpy.visu.html" class="md-nav__link">electricpy.visu</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../constants.html" class="md-nav__link">Constants</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../additionalresources.html" class="md-nav__link">Additional Resources</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../../additionalresources.html#generic-and-data-science" class="md-nav__link">Generic and Data Science</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../additionalresources.html#electrical-engineering-focus" class="md-nav__link">Electrical Engineering Focus</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../changes.html" class="md-nav__link">Recent Changes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="https://github.com/engineerjoe440/ElectricPy" class="md-nav__link">Github</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="https://pypi.org/project/electricpy" class="md-nav__link">PyPI</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
  <ul class="md-nav__list" data-md-scrollfix="">
    

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <h1 id="modules-electricpy-fault--page-root">Source code for electricpy.fault</h1><div class="highlight"><pre>
<span></span><span class="c1">################################################################################</span>
<span class="sd">"""</span>
<span class="sd">`electricpy.fault` - Electrical Power Engineering Faults Calculations.</span>

<span class="sd">&gt;&gt;&gt; from electricpy import fault</span>
<span class="sd">"""</span>
<span class="c1">################################################################################</span>

<span class="c1"># Import Necessary Dependencies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">_np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">_plt</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span> <span class="k">as</span> <span class="n">_fsolve</span>

<span class="c1"># Import Local Dependencies</span>
<span class="kn">from</span> <span class="nn">.constants</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">_phaseroll</span><span class="p">(</span><span class="n">M012</span><span class="p">,</span><span class="n">reference</span><span class="p">):</span>
    <span class="c1"># Compute Dot Product</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">A012</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M012</span><span class="p">)</span>
    <span class="c1"># Condition Reference:</span>
    <span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">reference</span> <span class="o">==</span> <span class="s1">'A'</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">reference</span> <span class="o">==</span> <span class="s1">'B'</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">reference</span> <span class="o">==</span> <span class="s1">'C'</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Invalid Phase Reference."</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="c1"># Define Single Line to Ground Fault Function</span>
<div class="viewcode-block" id="phs1g"><a class="viewcode-back" href="../../api/electricpy.fault.phs1g.html#electricpy.fault.phs1g">[docs]</a><span class="k">def</span> <span class="nf">phs1g</span><span class="p">(</span><span class="n">Vth</span><span class="p">,</span><span class="n">Zseq</span><span class="p">,</span><span class="n">Rf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sequence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">reference</span><span class="o">=</span><span class="s1">'A'</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Single-Phase-to-Ground Fault Calculator.</span>

<span class="sd">    This function will evaluate the Zero, Positive, and Negative</span>
<span class="sd">    sequence currents for a single-line-to-ground fault.</span>

<span class="sd">    .. math:: I_1 = \frac{V_{th}}{Z_0+Z_1+Z_2+3*R_f}</span>

<span class="sd">    .. math:: I_2 = I_1</span>

<span class="sd">    .. math:: I_0 = I_1</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Vth:        complex</span>
<span class="sd">                The Thevenin-Equivalent-Voltage</span>
<span class="sd">    Zseq:       list of complex</span>
<span class="sd">                Tupple of sequence reactances as (Z0, Z1, Z2)</span>
<span class="sd">    Rf:         complex, optional</span>
<span class="sd">                The fault resistance, default=0</span>
<span class="sd">    sequence:   bool, optional</span>
<span class="sd">                Control argument to force return into symmetrical-</span>
<span class="sd">                or phase-domain values.</span>
<span class="sd">    reference:  {'A', 'B', 'C'}</span>
<span class="sd">                Single character denoting the reference,</span>
<span class="sd">                default='A'</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Ifault:     list of complex,</span>
<span class="sd">                The Array of Fault Currents as (If0, If1, If2)</span>
<span class="sd">    """</span>
    <span class="c1"># Decompose Reactance Tuple</span>
    <span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span> <span class="o">=</span> <span class="n">Zseq</span>
    <span class="c1"># Ensure that X-components are imaginary</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X0</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X1</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X2</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="c1"># Calculate Fault Current</span>
    <span class="n">Ifault</span> <span class="o">=</span> <span class="n">Vth</span> <span class="o">/</span> <span class="p">(</span><span class="n">X0</span> <span class="o">+</span> <span class="n">X1</span> <span class="o">+</span> <span class="n">X2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">Rf</span><span class="p">)</span>
    <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">Ifault</span><span class="p">,</span> <span class="n">Ifault</span><span class="p">,</span> <span class="n">Ifault</span> <span class="p">])</span>
    <span class="c1"># Prepare Value for return</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_phaseroll</span><span class="p">(</span> <span class="n">Ifault</span><span class="p">,</span> <span class="n">reference</span> <span class="p">)</span> <span class="c1"># Convert to ABC-Domain</span>
    <span class="c1"># Return Value</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Ifault</span><span class="p">)</span></div>

<span class="c1"># Define Double Line to Ground Fault Current Calculator</span>
<div class="viewcode-block" id="phs2g"><a class="viewcode-back" href="../../api/electricpy.fault.phs2g.html#electricpy.fault.phs2g">[docs]</a><span class="k">def</span> <span class="nf">phs2g</span><span class="p">(</span><span class="n">Vth</span><span class="p">,</span><span class="n">Zseq</span><span class="p">,</span><span class="n">Rf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sequence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">reference</span><span class="o">=</span><span class="s1">'A'</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Double-Line-to-Ground Fault Calculator.</span>

<span class="sd">    This function will evaluate the Zero, Positive, and Negative</span>
<span class="sd">    sequence currents for a double-line-to-ground fault.</span>

<span class="sd">    .. math:: I_1 = \frac{V_{th}}{Z_1+\frac{Z_2*(Z_0+3*R_f)}{Z_0+Z_2+3*R_f}}</span>

<span class="sd">    .. math:: I_2 = -\frac{V_{th}-Z_1*I_1}{X_2}</span>

<span class="sd">    .. math:: I_0 = -\frac{V_{th}-Z_1*I_1}{X_0+3*R_f}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Vth:        complex</span>
<span class="sd">                The Thevenin-Equivalent-Voltage</span>
<span class="sd">    Zseq:       list of complex</span>
<span class="sd">                Tupple of sequence reactances as (Z0, Z1, Z2)</span>
<span class="sd">    Rf:         complex, optional</span>
<span class="sd">                The fault resistance, default=0</span>
<span class="sd">    sequence:   bool, optional</span>
<span class="sd">                Control argument to force return into symmetrical-</span>
<span class="sd">                or phase-domain values.</span>
<span class="sd">    reference:  {'A', 'B', 'C'}</span>
<span class="sd">                Single character denoting the reference,</span>
<span class="sd">                default='A'</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Ifault:     list of complex,</span>
<span class="sd">                The Array of Fault Currents as (If0, If1, If2)</span>
<span class="sd">    """</span>
    <span class="c1"># Decompose Reactance Tuple</span>
    <span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span> <span class="o">=</span> <span class="n">Zseq</span>
    <span class="c1"># Ensure that X-components are imaginary</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X0</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X1</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X2</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="c1"># Calculate Fault Currents</span>
    <span class="n">If1</span> <span class="o">=</span> <span class="n">Vth</span> <span class="o">/</span> <span class="p">(</span><span class="n">X1</span> <span class="o">+</span> <span class="p">(</span><span class="n">X2</span><span class="o">*</span><span class="p">(</span><span class="n">X0</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">Rf</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">X0</span><span class="o">+</span><span class="n">X2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">Rf</span><span class="p">))</span>
    <span class="n">If2</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Vth</span> <span class="o">-</span> <span class="n">X1</span><span class="o">*</span><span class="n">If1</span><span class="p">)</span><span class="o">/</span><span class="n">X2</span>
    <span class="n">If0</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Vth</span> <span class="o">-</span> <span class="n">X1</span><span class="o">*</span><span class="n">If1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">X0</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">Rf</span><span class="p">)</span>
    <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">If0</span><span class="p">,</span> <span class="n">If1</span><span class="p">,</span> <span class="n">If2</span><span class="p">])</span>
    <span class="c1"># Return Currents</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_phaseroll</span><span class="p">(</span> <span class="n">Ifault</span><span class="p">,</span> <span class="n">reference</span> <span class="p">)</span> <span class="c1"># Convert to ABC-Domain</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Ifault</span><span class="p">)</span></div>

<span class="c1"># Define Phase-to-Phase Fault Current Calculator</span>
<div class="viewcode-block" id="phs2"><a class="viewcode-back" href="../../api/electricpy.fault.phs2.html#electricpy.fault.phs2">[docs]</a><span class="k">def</span> <span class="nf">phs2</span><span class="p">(</span><span class="n">Vth</span><span class="p">,</span><span class="n">Zseq</span><span class="p">,</span><span class="n">Rf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sequence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">reference</span><span class="o">=</span><span class="s1">'A'</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Line-to-Line Fault Calculator.</span>

<span class="sd">    This function will evaluate the Zero, Positive, and Negative</span>
<span class="sd">    sequence currents for a phase-to-phase fault.</span>

<span class="sd">    .. math:: I_1 = \frac{V_{th}}{Z_1+Z_2+R_f}</span>

<span class="sd">    .. math:: I_2 = -I_1</span>

<span class="sd">    .. math:: I_0 = 0</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Vth:        complex</span>
<span class="sd">                The Thevenin-Equivalent-Voltage</span>
<span class="sd">    Zseq:       list of complex</span>
<span class="sd">                Tupple of sequence reactances as (Z0, Z1, Z2)</span>
<span class="sd">    Rf:         complex, optional</span>
<span class="sd">                The fault resistance, default=0</span>
<span class="sd">    sequence:   bool, optional</span>
<span class="sd">                Control argument to force return into symmetrical-</span>
<span class="sd">                or phase-domain values.</span>
<span class="sd">    reference:  {'A', 'B', 'C'}</span>
<span class="sd">                Single character denoting the reference,</span>
<span class="sd">                default='A'</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Ifault:     list of complex,</span>
<span class="sd">                The Array of Fault Currents as (If0, If1, If2)</span>
<span class="sd">    """</span>
    <span class="c1"># Decompose Reactance Tuple</span>
    <span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span> <span class="o">=</span> <span class="n">Zseq</span>
    <span class="c1"># Ensure that X-components are imaginary</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X0</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X1</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X2</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="c1"># Calculate Fault Currents</span>
    <span class="n">If0</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">If1</span> <span class="o">=</span> <span class="n">Vth</span> <span class="o">/</span> <span class="p">(</span><span class="n">X1</span> <span class="o">+</span> <span class="n">X2</span> <span class="o">+</span> <span class="n">Rf</span><span class="p">)</span>
    <span class="n">If2</span> <span class="o">=</span> <span class="o">-</span><span class="n">If1</span>
    <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">If0</span><span class="p">,</span> <span class="n">If1</span><span class="p">,</span> <span class="n">If2</span><span class="p">])</span>
    <span class="c1"># Return Currents</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_phaseroll</span><span class="p">(</span> <span class="n">Ifault</span><span class="p">,</span> <span class="n">reference</span> <span class="p">)</span> <span class="c1"># Convert to ABC-Domain</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Ifault</span><span class="p">)</span></div>

<span class="c1"># Define Three-Phase Fault Current Calculator</span>
<div class="viewcode-block" id="phs3"><a class="viewcode-back" href="../../api/electricpy.fault.phs3.html#electricpy.fault.phs3">[docs]</a><span class="k">def</span> <span class="nf">phs3</span><span class="p">(</span><span class="n">Vth</span><span class="p">,</span><span class="n">Zseq</span><span class="p">,</span><span class="n">Rf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sequence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">reference</span><span class="o">=</span><span class="s1">'A'</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Three-Phase Fault Calculator.</span>

<span class="sd">    This function will evaluate the Zero, Positive, and Negative</span>
<span class="sd">    sequence currents for a three-phase fault.</span>

<span class="sd">    .. math:: I_1 = \frac{V_{th}}{Z_1+R_1}</span>

<span class="sd">    .. math:: I_2 = 0</span>

<span class="sd">    .. math:: I_0 = 0</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Vth:        complex</span>
<span class="sd">                The Thevenin-Equivalent-Voltage</span>
<span class="sd">    Zseq:       list of complex</span>
<span class="sd">                Tupple of sequence reactances as (Z0, Z1, Z2)</span>
<span class="sd">    Rf:         complex, optional</span>
<span class="sd">                The fault resistance, default=0</span>
<span class="sd">    sequence:   bool, optional</span>
<span class="sd">                Control argument to force return into symmetrical-</span>
<span class="sd">                or phase-domain values.</span>
<span class="sd">    reference:  {'A', 'B', 'C'}</span>
<span class="sd">                Single character denoting the reference,</span>
<span class="sd">                default='A'</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Ifault:     list of complex</span>
<span class="sd">                The Fault Current, equal for 0, pos., and neg. seq.</span>
<span class="sd">    """</span>
    <span class="c1"># Decompose Reactance Tuple</span>
    <span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span> <span class="o">=</span> <span class="n">Zseq</span>
    <span class="c1"># Ensure that X-components are imaginary</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X1</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="c1"># Calculate Fault Currents</span>
    <span class="n">Ifault</span> <span class="o">=</span> <span class="n">Vth</span><span class="o">/</span><span class="p">(</span><span class="n">X1</span> <span class="o">+</span> <span class="n">Rf</span><span class="p">)</span>
    <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Ifault</span><span class="p">,</span> <span class="mi">0</span> <span class="p">])</span>
    <span class="c1"># Prepare to Return Value</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_phaseroll</span><span class="p">(</span> <span class="n">Ifault</span><span class="p">,</span> <span class="n">reference</span> <span class="p">)</span> <span class="c1"># Convert to ABC-Domain</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Ifault</span><span class="p">)</span></div>

<span class="c1"># Define Single Pole Open Calculator</span>
<div class="viewcode-block" id="poleopen1"><a class="viewcode-back" href="../../api/electricpy.fault.poleopen1.html#electricpy.fault.poleopen1">[docs]</a><span class="k">def</span> <span class="nf">poleopen1</span><span class="p">(</span><span class="n">Vth</span><span class="p">,</span><span class="n">Zseq</span><span class="p">,</span><span class="n">sequence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">reference</span><span class="o">=</span><span class="s1">'A'</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Single Pole Open Fault Calculator.</span>

<span class="sd">    This function will evaluate the Zero, Positive, and Negative</span>
<span class="sd">    sequence currents for a single pole open fault.</span>

<span class="sd">    .. math:: I_1 = \frac{V_{th}}{Z_1+(\frac{1}{Z_2}+\frac{1}{Z_0})^-1}</span>

<span class="sd">    .. math:: I_2 = -I_1 * \frac{Z_0}{Z_2+Z_0}</span>

<span class="sd">    .. math:: I_0 = -I_1 * \frac{Z_2}{Z_2+Z_0}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Vth:        complex</span>
<span class="sd">                The Thevenin-Equivalent-Voltage</span>
<span class="sd">    Zseq:       list of complex</span>
<span class="sd">                Tupple of sequence reactances as (Z0, Z1, Z2)</span>
<span class="sd">    sequence:   bool, optional</span>
<span class="sd">                Control argument to force return into symmetrical-</span>
<span class="sd">                or phase-domain values.</span>
<span class="sd">    reference:  {'A', 'B', 'C'}</span>
<span class="sd">                Single character denoting the reference, or the</span>
<span class="sd">                faulted phase indicator; default='A'</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Ifault:     list of complex,</span>
<span class="sd">                The Array of Fault Currents as (If0, If1, If2)</span>
<span class="sd">    """</span>
    <span class="c1"># Decompose Reactance Tuple</span>
    <span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span> <span class="o">=</span> <span class="n">Zseq</span>
    <span class="c1"># Ensure that X-components are imaginary</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X0</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X1</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X2</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="c1"># Calculate Fault Currents</span>
    <span class="n">If1</span> <span class="o">=</span> <span class="n">Vth</span> <span class="o">/</span> <span class="p">(</span><span class="n">X1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">X2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">X0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">If2</span> <span class="o">=</span> <span class="o">-</span><span class="n">If1</span> <span class="o">*</span> <span class="n">X0</span><span class="o">/</span><span class="p">(</span><span class="n">X2</span> <span class="o">+</span> <span class="n">X0</span><span class="p">)</span>
    <span class="n">If0</span> <span class="o">=</span> <span class="o">-</span><span class="n">If1</span> <span class="o">*</span> <span class="n">X2</span><span class="o">/</span><span class="p">(</span><span class="n">X2</span> <span class="o">+</span> <span class="n">X0</span><span class="p">)</span>
    <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">If0</span><span class="p">,</span> <span class="n">If1</span><span class="p">,</span> <span class="n">If2</span><span class="p">])</span>
    <span class="c1"># Return Currents</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_phaseroll</span><span class="p">(</span> <span class="n">Ifault</span><span class="p">,</span> <span class="n">reference</span> <span class="p">)</span> <span class="c1"># Convert to ABC-Domain</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Ifault</span><span class="p">)</span></div>

<span class="c1"># Define Double Pole Open Calculator</span>
<div class="viewcode-block" id="poleopen2"><a class="viewcode-back" href="../../api/electricpy.fault.poleopen2.html#electricpy.fault.poleopen2">[docs]</a><span class="k">def</span> <span class="nf">poleopen2</span><span class="p">(</span><span class="n">Vth</span><span class="p">,</span><span class="n">Zseq</span><span class="p">,</span><span class="n">sequence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">reference</span><span class="o">=</span><span class="s1">'A'</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Single Pole Open Fault Calculator.</span>

<span class="sd">    This function will evaluate the Zero, Positive, and Negative</span>
<span class="sd">    sequence currents for a single pole open fault.</span>

<span class="sd">    .. math:: I_1 = \frac{V_{th}}{Z_1+Z_2+Z_0}</span>

<span class="sd">    .. math:: I_2 = I_1</span>

<span class="sd">    .. math:: I_0 = I_1</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Vth:        complex</span>
<span class="sd">                The Thevenin-Equivalent-Voltage</span>
<span class="sd">    Zseq:       list of complex</span>
<span class="sd">                Tupple of sequence reactances as (Z0, Z1, Z2)</span>
<span class="sd">    sequence:   bool, optional</span>
<span class="sd">                Control argument to force return into symmetrical-</span>
<span class="sd">                or phase-domain values.</span>
<span class="sd">    reference:  {'A', 'B', 'C'}</span>
<span class="sd">                Single character denoting the reference, or the</span>
<span class="sd">                faulted phase indicator; default='A'</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Ifault:     list of complex,</span>
<span class="sd">                The Array of Fault Currents as (If0, If1, If2)</span>
<span class="sd">    """</span>
    <span class="c1"># Decompose Reactance Tuple</span>
    <span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span> <span class="o">=</span> <span class="n">Zseq</span>
    <span class="c1"># Ensure that X-components are imaginary</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X0</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X1</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X2</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="c1"># Calculate Fault Currents</span>
    <span class="n">If1</span> <span class="o">=</span> <span class="n">Vth</span> <span class="o">/</span> <span class="p">(</span><span class="n">X1</span> <span class="o">+</span> <span class="n">X2</span> <span class="o">+</span> <span class="n">X0</span><span class="p">)</span>
    <span class="n">If2</span> <span class="o">=</span> <span class="n">If1</span>
    <span class="n">If0</span> <span class="o">=</span> <span class="n">If1</span>
    <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">If0</span><span class="p">,</span> <span class="n">If1</span><span class="p">,</span> <span class="n">If2</span><span class="p">])</span>
    <span class="c1"># Return Currents</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">Ifault</span> <span class="o">=</span> <span class="n">_phaseroll</span><span class="p">(</span> <span class="n">Ifault</span><span class="p">,</span> <span class="n">reference</span> <span class="p">)</span> <span class="c1"># Convert to ABC-Domain</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Ifault</span><span class="p">)</span></div>

<span class="c1"># Define MVA Short Circuit</span>
<div class="viewcode-block" id="scMVA"><a class="viewcode-back" href="../../api/electricpy.fault.scMVA.html#electricpy.fault.scMVA">[docs]</a><span class="k">def</span> <span class="nf">scMVA</span><span class="p">(</span><span class="n">Zth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Isc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Vth</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Short-Circuit MVA Calculator.</span>

<span class="sd">    Function defines a method of interpretively</span>
<span class="sd">    calculating the short-circuit MVA value</span>
<span class="sd">    given two of the three arguments. The formulas</span>
<span class="sd">    are all based around the following:</span>

<span class="sd">    .. math:: MVA_{sc} = V_{th}*I_{sc}</span>

<span class="sd">    .. math:: V_{th} = I_{sc}*Z_{th}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Zth:        float</span>
<span class="sd">                The Thevenin-Equivalent-Impedance</span>
<span class="sd">    Isc:        float, optional</span>
<span class="sd">                Short-Circuit-Current, if left as</span>
<span class="sd">                None, will force function to use</span>
<span class="sd">                default setting for Vth.</span>
<span class="sd">                default=None</span>
<span class="sd">    Vth:        float, optional</span>
<span class="sd">                The Thevenin-Equivalent-Voltage,</span>
<span class="sd">                defaults to a 1-per-unit value.</span>
<span class="sd">                default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MVA:        float</span>
<span class="sd">                Short-Circuit MVA, not described</span>
<span class="sd">                as three-phase or otherwise, such</span>
<span class="sd">                determination is dependent upon</span>
<span class="sd">                inputs.</span>
<span class="sd">    """</span>
    <span class="c1"># Test for too few inputs</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">((</span><span class="n">Zth</span><span class="p">,</span><span class="n">Isc</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Either Zth or Isc must be specified."</span><span class="p">)</span>
    <span class="c1"># Condition Inputs</span>
    <span class="k">if</span> <span class="n">Zth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Zth</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Zth</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Isc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Isc</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Isc</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Vth</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">Vth</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Vth</span><span class="p">)</span>
    <span class="c1"># Calculate MVA from one of the available methods</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">((</span><span class="n">Zth</span><span class="p">,</span><span class="n">Isc</span><span class="p">)):</span>
        <span class="n">MVA</span> <span class="o">=</span> <span class="n">Isc</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Zth</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">((</span><span class="n">Zth</span><span class="p">,</span><span class="n">Vth</span><span class="p">)):</span>
        <span class="n">MVA</span> <span class="o">=</span> <span class="n">Vth</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">Zth</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">MVA</span> <span class="o">=</span> <span class="n">Vth</span> <span class="o">*</span> <span class="n">Isc</span>
    <span class="c1"># Return Value</span>
    <span class="k">return</span><span class="p">(</span><span class="n">MVA</span><span class="p">)</span></div>

<span class="c1"># Define Explicitly 3-Phase MVAsc Calculator</span>
<div class="viewcode-block" id="phs3mvasc"><a class="viewcode-back" href="../../api/electricpy.fault.phs3mvasc.html#electricpy.fault.phs3mvasc">[docs]</a><span class="k">def</span> <span class="nf">phs3mvasc</span><span class="p">(</span><span class="n">Vth</span><span class="p">,</span><span class="n">Zseq</span><span class="p">,</span><span class="n">Rf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Sbase</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Three-Phase MVA Short-Circuit Calculator.</span>

<span class="sd">    Calculator to evaluate the Short-Circuit MVA of a three-phase fault given the system</span>
<span class="sd">    parameters of Vth, Zseq, and an optional Rf. Uses the formula as follows:</span>

<span class="sd">    .. math:: MVA_{sc} = \frac{\left|V_{th}^2\right|}{|Z_1|} * Sbase</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Vth:        complex</span>
<span class="sd">                The Thevenin-Equivalent-Voltage</span>
<span class="sd">    Zseq:       list of complex</span>
<span class="sd">                Tupple of sequence reactances as (Z0, Z1, Z2)</span>
<span class="sd">    Rf:         complex, optional</span>
<span class="sd">                The fault resistance, default=0</span>
<span class="sd">    Sbase:      real, optional</span>
<span class="sd">                The per-unit base for power. default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MVA:        real</span>
<span class="sd">                Three-Phase Short-Circuit MVA.</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate Three-Phase MVA</span>
    <span class="n">MVA</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Vth</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Zseq</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">Sbase</span>
    <span class="c1"># Scale VA to MVA if Sbase is not 1</span>
    <span class="k">if</span> <span class="n">Sbase</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">MVA</span> <span class="o">=</span> <span class="n">MVA</span> <span class="o">*</span> <span class="mf">1e-6</span> <span class="c1"># Divide by 1e6 (M)</span>
    <span class="c1"># Return</span>
    <span class="k">return</span><span class="p">(</span><span class="n">MVA</span><span class="p">)</span></div>


<span class="c1"># Define Explicitly 1-Phase MVAsc Calculator</span>
<div class="viewcode-block" id="phs1mvasc"><a class="viewcode-back" href="../../api/electricpy.fault.phs1mvasc.html#electricpy.fault.phs1mvasc">[docs]</a><span class="k">def</span> <span class="nf">phs1mvasc</span><span class="p">(</span><span class="n">Vth</span><span class="p">,</span><span class="n">Zseq</span><span class="p">,</span><span class="n">Rf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Sbase</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Single-Phase MVA Short-Circuit Calculator.</span>

<span class="sd">    Calculator to evaluate the Short-Circuit MVA of a single-phase fault given the system</span>
<span class="sd">    parameters of Vth, Zseq, and an optional Rf. Uses the formula as follows:</span>

<span class="sd">    .. math:: MVA_{sc} = \left|I_1^2\right|*|Z_1| * Sbase</span>

<span class="sd">    where:</span>

<span class="sd">    .. math:: I_1 = \frac{V_{th}}{Z_0+Z_1+Z_2+3*R_f}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Vth:        complex</span>
<span class="sd">                The Thevenin-Equivalent-Voltage</span>
<span class="sd">    Zseq:       list of complex</span>
<span class="sd">                Tupple of sequence reactances as (Z0, Z1, Z2)</span>
<span class="sd">    Rf:         complex, optional</span>
<span class="sd">                The fault resistance, default=0</span>
<span class="sd">    Sbase:      real, optional</span>
<span class="sd">                The per-unit base for power. default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    MVA:        real</span>
<span class="sd">                Single-Phase Short-Circuit MVA.</span>
<span class="sd">    """</span>
    <span class="c1"># Decompose Reactance Tuple</span>
    <span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span> <span class="o">=</span> <span class="n">Zseq</span>
    <span class="c1"># Ensure that X-components are imaginary</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X0</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X1</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)):</span> <span class="n">X2</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span>
    <span class="c1"># Calculate Fault Current</span>
    <span class="n">Ifault</span> <span class="o">=</span> <span class="n">Vth</span> <span class="o">/</span> <span class="p">(</span><span class="n">X0</span> <span class="o">+</span> <span class="n">X1</span> <span class="o">+</span> <span class="n">X2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">Rf</span><span class="p">)</span>
    <span class="c1"># Calculate MVA</span>
    <span class="n">MVA</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Ifault</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Sbase</span>
    <span class="c1"># Scale VA to MVA if Sbase is not 1</span>
    <span class="k">if</span> <span class="n">Sbase</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">MVA</span> <span class="o">=</span> <span class="n">MVA</span> <span class="o">*</span> <span class="mf">1e-6</span> <span class="c1"># Divide by 1e6 (M)</span>
    <span class="c1"># Return</span>
    <span class="k">return</span><span class="p">(</span><span class="n">MVA</span><span class="p">)</span></div>

<span class="c1"># Define Faulted Bus Voltage Calculator</span>
<div class="viewcode-block" id="busvolt"><a class="viewcode-back" href="../../api/electricpy.fault.busvolt.html#electricpy.fault.busvolt">[docs]</a><span class="k">def</span> <span class="nf">busvolt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Vpf</span><span class="p">,</span><span class="n">Z0</span><span class="p">,</span><span class="n">Z1</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">If</span><span class="p">,</span><span class="n">sequence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">reference</span><span class="o">=</span><span class="s1">'A'</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Faulted Bus Voltage Calculator.</span>

<span class="sd">    This function is designed to calculate the bus voltage(s)</span>
<span class="sd">    given a specific set of fault characteristics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    k:          float</span>
<span class="sd">                Bus index at which to calculate faulted voltage</span>
<span class="sd">    n:          float</span>
<span class="sd">                Bus index at which fault occurred</span>
<span class="sd">    Vpf:        complex</span>
<span class="sd">                Voltage Pre-Fault, Singular Number</span>
<span class="sd">    Z0:         ndarray</span>
<span class="sd">                Zero-Sequence Impedance Matrix</span>
<span class="sd">    Z1:         ndarray</span>
<span class="sd">                Positive-Sequence Impedance Matrix</span>
<span class="sd">    Z2:         ndarray</span>
<span class="sd">                Negative-Sequence Impedance Matrix</span>
<span class="sd">    If:         complex</span>
<span class="sd">                Sequence Fault Current Evaluated at Bus *n*</span>
<span class="sd">    sequence:   bool, optional</span>
<span class="sd">                Control argument to force return into symmetrical-</span>
<span class="sd">                or phase-domain values.</span>
<span class="sd">    reference:  {'A', 'B', 'C'}</span>
<span class="sd">                Single character denoting the reference,</span>
<span class="sd">                default='A'</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Vf:         complex</span>
<span class="sd">                The Fault Voltage, set of sequence or phase voltages as</span>
<span class="sd">                specified by *sequence*</span>
<span class="sd">    """</span>
    <span class="c1"># Condition Inputs</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">Z0</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z0</span><span class="p">)</span>
    <span class="n">Z1</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z1</span><span class="p">)</span>
    <span class="n">Z2</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Z2</span><span class="p">)</span>
    <span class="n">If</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">If</span><span class="p">)</span>
    <span class="c1"># Generate Arrays For Calculation</span>
    <span class="n">Vfmat</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">Vpf</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="n">Zmat</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">Z0</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z1</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span>
                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Z2</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">]]])</span>
    <span class="c1"># Perform Calculation</span>
    <span class="n">Vf</span> <span class="o">=</span> <span class="n">Vfmat</span> <span class="o">-</span> <span class="n">Zmat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">If</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">Vf</span> <span class="o">=</span> <span class="n">_phaseroll</span><span class="p">(</span> <span class="n">Vf</span><span class="p">,</span> <span class="n">reference</span> <span class="p">)</span> <span class="c1"># Convert to ABC-Domain</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Vf</span><span class="p">)</span></div>


<span class="c1"># Define CT Saturation Function</span>
<div class="viewcode-block" id="ct_saturation"><a class="viewcode-back" href="../../api/electricpy.fault.ct_saturation.html#electricpy.fault.ct_saturation">[docs]</a><span class="k">def</span> <span class="nf">ct_saturation</span><span class="p">(</span><span class="n">XoR</span><span class="p">,</span><span class="n">Imag</span><span class="p">,</span><span class="n">Vrated</span><span class="p">,</span><span class="n">Irated</span><span class="p">,</span><span class="n">CTR</span><span class="p">,</span><span class="n">Rb</span><span class="p">,</span><span class="n">Xb</span><span class="p">,</span><span class="n">remnance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">ALF</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Electrical Current Transformer Saturation Calculator.</span>

<span class="sd">    A function to determine the saturation value and a boolean indicator</span>
<span class="sd">    showing whether or not CT is -in fact- saturated.</span>

<span class="sd">    To perform this evaluation, we must satisfy the equation:</span>

<span class="sd">    .. math::</span>
<span class="sd">       20\geq(1+\frac{X}{R})*\frac{|I_{mag}|}{I_{rated}*CTR}</span>
<span class="sd">       *\frac{\left|R_{burden}+j*\omega*\frac{X_{burden}}</span>
<span class="sd">       {\omega}\right|*100}{V_{rated}*(1-remnanc)}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    XoR:        float</span>
<span class="sd">                The X-over-R ratio of the system.</span>
<span class="sd">    Imag:       float</span>
<span class="sd">                The (maximum) current magnitude to use for calculation,</span>
<span class="sd">                typically the fault current.</span>
<span class="sd">    Vrated:     float</span>
<span class="sd">                The rated voltage (accompanying the C-Class value) of</span>
<span class="sd">                the CT.</span>
<span class="sd">    Irated:     float</span>
<span class="sd">                The rated secondary current for the CT.</span>
<span class="sd">    CTR:        float</span>
<span class="sd">                The CT Ratio (primary/secondary, N) to be used.</span>
<span class="sd">    Rb:         float</span>
<span class="sd">                The total burden resistance in ohms.</span>
<span class="sd">    Xb:         float</span>
<span class="sd">                The total burden reactance in ohms.</span>
<span class="sd">    remnance:   float, optional</span>
<span class="sd">                The system flux remnance, default=0.</span>
<span class="sd">    freq:       float, optional</span>
<span class="sd">                The system frequency in Hz, default=60.</span>
<span class="sd">    ALF:        float, optional</span>
<span class="sd">                The Saturation Constant which must be satisfied,</span>
<span class="sd">                default=20.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    result:     float</span>
<span class="sd">                The calculated Saturation value.</span>
<span class="sd">    saturation: bool</span>
<span class="sd">                Boolean indicator to mark presence of saturation.</span>
<span class="sd">    """</span>
    <span class="c1"># Define omega</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span>
    <span class="c1"># Find Lb</span>
    <span class="n">Lb</span> <span class="o">=</span> <span class="n">Xb</span><span class="o">/</span><span class="n">w</span>
    <span class="c1"># Re-evaluate Vrated</span>
    <span class="n">Vrated</span> <span class="o">=</span> <span class="n">Vrated</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">remnance</span><span class="p">)</span>
    <span class="c1"># Calculate each "term" (multiple)</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">XoR</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Imag</span><span class="o">/</span><span class="p">(</span><span class="n">Irated</span><span class="o">*</span><span class="n">CTR</span><span class="p">))</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Rb</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">Lb</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">Vrated</span>
    <span class="c1"># Evaluate</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="n">t2</span><span class="o">*</span><span class="n">t3</span>
    <span class="c1"># Test for saturation</span>
    <span class="n">saturation</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&gt;=</span> <span class="n">ALF</span>
    <span class="c1"># Return Results</span>
    <span class="k">return</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="n">saturation</span><span class="p">)</span></div>


<span class="c1"># Define C-Class Calculator</span>
<div class="viewcode-block" id="ct_cclass"><a class="viewcode-back" href="../../api/electricpy.fault.ct_cclass.html#electricpy.fault.ct_cclass">[docs]</a><span class="k">def</span> <span class="nf">ct_cclass</span><span class="p">(</span><span class="n">XoR</span><span class="p">,</span><span class="n">Imag</span><span class="p">,</span><span class="n">Irated</span><span class="p">,</span><span class="n">CTR</span><span class="p">,</span><span class="n">Rb</span><span class="p">,</span><span class="n">Xb</span><span class="p">,</span><span class="n">remnance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sat_crit</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Electrical Current Transformer (CT) C-Class Function.</span>

<span class="sd">    A function to determine the C-Class rated voltage for a CT.</span>
<span class="sd">    The formula shown below demonstrates the standard formula</span>
<span class="sd">    which is normally used to evaluate the saturation criteria.</span>
<span class="sd">    Worth noting here, is the fact that :math:`V_{rated}` is the</span>
<span class="sd">    CT C-Class.</span>

<span class="sd">    .. math::</span>
<span class="sd">       \text{Saturation Criteria}=\frac{(1+\frac{X}{R})\cdot</span>
<span class="sd">       \frac{|I_{mag}|}{I_{rated}\cdot CTR}\cdot\frac{\left|</span>
<span class="sd">       R_{burden}+j\cdot X_{burden}\right|\cdot100}{V_{rated}}}</span>
<span class="sd">       {1-remnance}</span>

<span class="sd">    For the purposes of this function, the above formula is applied</span>
<span class="sd">    as follows to evaluate the CT C-Class such as to satisfy the</span>
<span class="sd">    saturation criteria defined.</span>

<span class="sd">    .. math::</span>
<span class="sd">       \text{CT C-Class}=\frac{(1+\frac{X}{R})\cdot</span>
<span class="sd">       \frac{|I_{mag}|}{I_{rated}\cdot CTR}\cdot\frac{</span>
<span class="sd">       \left|R_{burden}+j\cdot X_{burden}\right|\cdot100}</span>
<span class="sd">       {\text{Saturation Criteria (i.e., 20)}}}{1-remnance}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    XoR:        float</span>
<span class="sd">                The X-over-R ratio of the system.</span>
<span class="sd">    Imag:       float</span>
<span class="sd">                The (maximum) current magnitude to use for calculation,</span>
<span class="sd">                typically the fault current.</span>
<span class="sd">    Irated:     float</span>
<span class="sd">                The rated secondary current for the CT.</span>
<span class="sd">    CTR:        float</span>
<span class="sd">                The CT Ratio (primary/secondary, N) to be used.</span>
<span class="sd">    Rb:         float</span>
<span class="sd">                The total burden resistance in ohms.</span>
<span class="sd">    Xb:         float</span>
<span class="sd">                The total burden reactance in ohms.</span>
<span class="sd">    remnance:   float, optional</span>
<span class="sd">                The system flux remnance, default=0.</span>
<span class="sd">    sat_crit:   float, optional</span>
<span class="sd">                The saturation criteria which must be satisfied,</span>
<span class="sd">                typically such that CT saturation will not occur,</span>
<span class="sd">                default=20.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    c_class:    float</span>
<span class="sd">                The calculated C-Class rated voltage.</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate each "term" (multiple)</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">XoR</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Imag</span><span class="o">/</span><span class="p">(</span><span class="n">Irated</span><span class="o">*</span><span class="n">CTR</span><span class="p">))</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Rb</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">Xb</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">sat_crit</span>
    <span class="c1"># Evaluate</span>
    <span class="n">Vr_w_rem</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="n">t2</span><span class="o">*</span><span class="n">t3</span>
    <span class="n">c_class</span> <span class="o">=</span> <span class="n">Vr_w_rem</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">remnance</span><span class="p">)</span>
    <span class="c1"># Return Result</span>
    <span class="k">return</span><span class="p">(</span><span class="n">c_class</span><span class="p">)</span></div>


<span class="c1"># Define Saturation Voltage at Rated Burden</span>
<div class="viewcode-block" id="ct_satratburden"><a class="viewcode-back" href="../../api/electricpy.fault.ct_satratburden.html#electricpy.fault.ct_satratburden">[docs]</a><span class="k">def</span> <span class="nf">ct_satratburden</span><span class="p">(</span><span class="n">Inom</span><span class="p">,</span><span class="n">VArat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ANSIv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ALF</span><span class="o">=</span><span class="mi">20</span><span class="p">,):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Electrical Current Transformer (CT) Saturation at Rated Burden Calculator.</span>

<span class="sd">    A function to determine the Saturation at rated burden.</span>

<span class="sd">    .. math:: V_{saturated}=ALF*\frac{VA_{rated}}{I_{nominal}}</span>

<span class="sd">    where:</span>

<span class="sd">    .. math:: VA_{rated}=I_{nominal}*\frac{ANSI_{voltage}}{20}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Inom:       float</span>
<span class="sd">                Nominal Current</span>
<span class="sd">    VArat:      float, optional, exclusive</span>
<span class="sd">                The apparent power (VA) rating of the CT.</span>
<span class="sd">    ANSIv:      float, optional, exclusive</span>
<span class="sd">                The ANSI voltage requirement to meet.</span>
<span class="sd">    ALF:        float, optional</span>
<span class="sd">                Accuracy Limit Factor, default=20.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Vsat:       float</span>
<span class="sd">                The saturated voltage.</span>
<span class="sd">    """</span>
    <span class="c1"># Validate Inputs</span>
    <span class="k">if</span> <span class="n">VArat</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ANSIv</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"VArat or ANSIv must be specified."</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">VArat</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Calculate VArat from ANSIv</span>
        <span class="n">VArat</span> <span class="o">=</span> <span class="n">Inom</span><span class="o">*</span><span class="n">ANSIv</span><span class="o">/</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># Determine Vsaturation</span>
    <span class="n">Vsat</span> <span class="o">=</span> <span class="n">ALF</span> <span class="o">*</span> <span class="n">VArat</span><span class="o">/</span><span class="n">Inom</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Vsat</span><span class="p">)</span></div>


<span class="c1"># Define CT Vpeak Formula</span>
<div class="viewcode-block" id="ct_vpeak"><a class="viewcode-back" href="../../api/electricpy.fault.ct_vpeak.html#electricpy.fault.ct_vpeak">[docs]</a><span class="k">def</span> <span class="nf">ct_vpeak</span><span class="p">(</span><span class="n">Zb</span><span class="p">,</span><span class="n">Ip</span><span class="p">,</span><span class="n">CTR</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Electrical Current Transformer (CT) Peak Voltage Calculator.</span>

<span class="sd">    Simple formula to calculate the Peak Voltage of a CT.</span>

<span class="sd">    .. math:: \sqrt{3.5*|Z_burden|*I_{peak}*CTR}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Zb:         float</span>
<span class="sd">                The burden impedance magnitude (in ohms).</span>
<span class="sd">    Ip:         float</span>
<span class="sd">                The peak current for the CT.</span>
<span class="sd">    CTR:        float</span>
<span class="sd">                The CTR turns ratio of the CT.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Vpeak:      float</span>
<span class="sd">                The peak voltage.</span>
<span class="sd">    """</span>
    <span class="k">return</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.5</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">Zb</span><span class="p">)</span><span class="o">*</span><span class="n">Ip</span><span class="o">*</span><span class="n">CTR</span><span class="p">))</span></div>


<span class="c1"># Define Saturation Time Calculator</span>
<div class="viewcode-block" id="ct_timetosat"><a class="viewcode-back" href="../../api/electricpy.fault.ct_timetosat.html#electricpy.fault.ct_timetosat">[docs]</a><span class="k">def</span> <span class="nf">ct_timetosat</span><span class="p">(</span><span class="n">Vknee</span><span class="p">,</span><span class="n">XoR</span><span class="p">,</span><span class="n">Rb</span><span class="p">,</span><span class="n">CTR</span><span class="p">,</span><span class="n">Imax</span><span class="p">,</span><span class="n">ts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">npts</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Electrical Current Transformer (CT) Time to Saturation Function.</span>

<span class="sd">    Function to determine the "time to saturate" for an underrated C-Class</span>
<span class="sd">    CT using three standard curves described by Juergen Holbach.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Vknee:      float</span>
<span class="sd">                The knee-voltage for the CT.</span>
<span class="sd">    XoR:        float</span>
<span class="sd">                The X-over-R ratio of the system.</span>
<span class="sd">    Rb:         float</span>
<span class="sd">                The total burden resistance in ohms.</span>
<span class="sd">    CTR:        float</span>
<span class="sd">                The CT Ratio (primary/secondary, N) to be used.</span>
<span class="sd">    Imax:       float</span>
<span class="sd">                The (maximum) current magnitude to use for calculation,</span>
<span class="sd">                typically the fault current.</span>
<span class="sd">    ts:         numpy.ndarray or float, optional</span>
<span class="sd">                The time-array or particular (floatint point) time at which</span>
<span class="sd">                to calculate the values. default=_np.linspace(0,0.1,freq*npts)</span>
<span class="sd">    npts:       float, optional</span>
<span class="sd">                The number of points (per cycle) to calculate if ts is not</span>
<span class="sd">                specified, default=100.</span>
<span class="sd">    freq:       float, optional</span>
<span class="sd">                The system frequency in Hz, default=60.</span>
<span class="sd">    plot:       bool, optional</span>
<span class="sd">                Control argument to enable plotting of calculated curves,</span>
<span class="sd">                default=False.</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate omega</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span>
    <span class="c1"># Calculate Tp</span>
    <span class="n">Tp</span> <span class="o">=</span> <span class="n">XoR</span><span class="o">/</span><span class="n">w</span>
    <span class="c1"># If ts isn't specified, generate it</span>
    <span class="k">if</span> <span class="n">ts</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="n">freq</span><span class="o">*</span><span class="n">npts</span><span class="p">)</span>
    <span class="c1"># Calculate inner term</span>
    <span class="n">term</span> <span class="o">=</span> <span class="o">-</span><span class="n">XoR</span><span class="o">*</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">ts</span><span class="o">/</span><span class="n">Tp</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Calculate Vsaturation terms</span>
    <span class="n">Vsat1</span> <span class="o">=</span> <span class="n">Imax</span><span class="o">*</span><span class="n">Rb</span><span class="o">*</span><span class="p">(</span><span class="n">term</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Vsat2</span> <span class="o">=</span> <span class="n">Imax</span><span class="o">*</span><span class="n">Rb</span><span class="o">*</span><span class="p">(</span><span class="n">term</span><span class="o">-</span><span class="n">_np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">ts</span><span class="p">))</span>
    <span class="n">Vsat3</span> <span class="o">=</span> <span class="n">Imax</span><span class="o">*</span><span class="n">Rb</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">_np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">ts</span><span class="p">))</span>
    <span class="c1"># If plotting requested</span>
    <span class="k">if</span> <span class="n">plot</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">_np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">Vsat1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">"Vsat1"</span><span class="p">)</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">Vsat2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">"Vsat2"</span><span class="p">)</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">Vsat3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">"Vsat3"</span><span class="p">)</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">Vknee</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">"V-knee"</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">)</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Saturation Curves"</span><span class="p">)</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Time (ts)"</span><span class="p">)</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">plot</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Unable to plot a single point, *ts* must be a numpy-array."</span><span class="p">)</span>
    <span class="c1"># Determine the crossover points for each saturation curve</span>
    <span class="n">Vsat1c</span> <span class="o">=</span> <span class="n">Vsat2c</span> <span class="o">=</span> <span class="n">Vsat3c</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">_np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">Vsat1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="n">Vknee</span> <span class="ow">and</span> <span class="n">Vsat1c</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">Vsat1c</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Vsat2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="n">Vknee</span> <span class="ow">and</span> <span class="n">Vsat2c</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">Vsat2c</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Vsat3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="n">Vknee</span> <span class="ow">and</span> <span class="n">Vsat3c</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">Vsat3c</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">(</span><span class="n">Vsat1c</span><span class="p">,</span><span class="n">Vsat2c</span><span class="p">,</span><span class="n">Vsat3c</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">(</span><span class="n">Vsat1</span><span class="p">,</span><span class="n">Vsat2</span><span class="p">,</span><span class="n">Vsat3</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">results</span><span class="p">)</span></div>

<span class="c1"># Define Function to Calculate TRV</span>
<div class="viewcode-block" id="pktransrecvolt"><a class="viewcode-back" href="../../api/electricpy.fault.pktransrecvolt.html#electricpy.fault.pktransrecvolt">[docs]</a><span class="k">def</span> <span class="nf">pktransrecvolt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">VLL</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">VLN</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Peak Transient Recovery Function.</span>

<span class="sd">    Peak Transient Recovery Voltage calculation function, evaluates the peak</span>
<span class="sd">    transient recovery voltage (restriking voltage) and the</span>
<span class="sd">    Rate-of-Rise-Recovery Voltage.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    C:          float</span>
<span class="sd">                Capacitance Value in Farads.</span>
<span class="sd">    L:          float</span>
<span class="sd">                Inductance in Henries.</span>
<span class="sd">    R:          float, optional</span>
<span class="sd">                The resistance of the system used for</span>
<span class="sd">                calculation, default=0.</span>
<span class="sd">    VLL:        float, exclusive</span>
<span class="sd">                Line-to-Line voltage, exclusive</span>
<span class="sd">                optional argument.</span>
<span class="sd">    VLN:        float, exclusive</span>
<span class="sd">                Line-to-Neutral voltage, exclusive</span>
<span class="sd">                optional argument.</span>
<span class="sd">    freq:       float, optional</span>
<span class="sd">                System frequency in Hz.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Vcpk:       float</span>
<span class="sd">                Peak Transient Recovery Voltage in volts.</span>
<span class="sd">    RRRV:       float</span>
<span class="sd">                The RRRV (Rate-of-Rise-Recovery Voltage)</span>
<span class="sd">                calculated given the parameters in volts</span>
<span class="sd">                per second.</span>
<span class="sd">    """</span>
    <span class="c1"># Evaluate alpha, omega-n, and fn</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">R</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="p">)</span>
    <span class="n">wn</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L</span><span class="o">*</span><span class="n">C</span><span class="p">)</span> <span class="o">-</span> <span class="n">alpha</span>
    <span class="n">fn</span> <span class="o">=</span> <span class="n">wn</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="c1"># Evaluate Vm</span>
    <span class="k">if</span> <span class="n">VLL</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">Vm</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">VLL</span>
    <span class="k">elif</span> <span class="n">VLN</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
        <span class="n">Vm</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">VLN</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"One voltage must be specified."</span><span class="p">)</span>
    <span class="c1"># Evaluate Vcpk (worst case)</span>
    <span class="n">Vcpk</span> <span class="o">=</span> <span class="n">wn</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">wn</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="p">)</span><span class="o">*</span><span class="n">Vm</span><span class="o">*</span><span class="mi">2</span>
    <span class="c1"># Evaluate RRRV</span>
    <span class="n">RRRV</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">Vm</span><span class="o">*</span><span class="n">fn</span><span class="o">/</span><span class="mf">0.5</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Vcpk</span><span class="p">,</span><span class="n">RRRV</span><span class="p">)</span></div>

<span class="c1"># Define TRV Reduction Resistor Function</span>
<div class="viewcode-block" id="trvresistor"><a class="viewcode-back" href="../../api/electricpy.fault.trvresistor.html#electricpy.fault.trvresistor">[docs]</a><span class="k">def</span> <span class="nf">trvresistor</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">reduction</span><span class="p">,</span><span class="n">Rd0</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">wd0</span><span class="o">=</span><span class="mf">260e3</span><span class="p">,</span><span class="n">tpk0</span><span class="o">=</span><span class="mf">10e-6</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Transient Recovery Voltage (TRV) Reduction Resistor Function.</span>

<span class="sd">    Function to find the resistor value that will reduce the TRV by a specified</span>
<span class="sd">    percentage.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    C:          float</span>
<span class="sd">                Capacitance Value in Farads.</span>
<span class="sd">    L:          float</span>
<span class="sd">                Inductance in Henries.</span>
<span class="sd">    reduction:  float</span>
<span class="sd">                The percentage that the TRV should be reduced by.</span>
<span class="sd">    Rd0:        float, optional</span>
<span class="sd">                Damping Resistor Evaluation Starting Point, default=500</span>
<span class="sd">    wd0:        float, optional</span>
<span class="sd">                Omega-d evaluation starting point, default=260*k</span>
<span class="sd">    tpk0:       float, optional</span>
<span class="sd">                Time of peak voltage evaluation starting point, default=10*u</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Rd:         float</span>
<span class="sd">                Damping resistor value, in ohms.</span>
<span class="sd">    wd:         float</span>
<span class="sd">                Omega-d</span>
<span class="sd">    tpk:        float</span>
<span class="sd">                Time of peak voltage.</span>
<span class="sd">    """</span>
    <span class="c1"># Evaluate omega-n</span>
    <span class="n">wn</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L</span><span class="o">*</span><span class="n">C</span><span class="p">)</span>
    <span class="c1"># Generate Constant Factor</span>
    <span class="n">fctr</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">reduction</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="c1"># Define Function Set</span>
    <span class="k">def</span> <span class="nf">equations</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">Rd</span><span class="p">,</span> <span class="n">wd</span><span class="p">,</span> <span class="n">tpk</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">wn</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Rd</span><span class="o">*</span><span class="n">C</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">wd</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">tpk</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Rd</span><span class="o">*</span><span class="n">C</span><span class="p">))</span><span class="o">-</span><span class="n">fctr</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">wd</span><span class="o">*</span><span class="n">tpk</span> <span class="o">-</span> <span class="n">_np</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">return</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span>
    <span class="n">Rd</span><span class="p">,</span> <span class="n">wd</span><span class="p">,</span> <span class="n">tpk</span> <span class="o">=</span> <span class="n">_fsolve</span><span class="p">(</span><span class="n">equations</span><span class="p">,</span> <span class="p">(</span><span class="n">Rd0</span><span class="p">,</span><span class="n">wd0</span><span class="p">,</span><span class="n">tpk0</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Rd</span><span class="p">,</span> <span class="n">wd</span><span class="p">,</span> <span class="n">tpk</span><span class="p">)</span></div>

<span class="c1"># Define Time-Overcurrent Trip Time Function</span>
<div class="viewcode-block" id="toctriptime"><a class="viewcode-back" href="../../api/electricpy.fault.toctriptime.html#electricpy.fault.toctriptime">[docs]</a><span class="k">def</span> <span class="nf">toctriptime</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">Ipickup</span><span class="p">,</span><span class="n">TD</span><span class="p">,</span><span class="n">curve</span><span class="o">=</span><span class="s2">"U1"</span><span class="p">,</span><span class="n">CTR</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Time OverCurrent Trip Time Function.</span>

<span class="sd">    Time-OverCurrent Trip Time Calculator, evaluates the time</span>
<span class="sd">    to trip for a specific TOC (51) element given the curve</span>
<span class="sd">    type, current characteristics and time-dial setting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    I:          float</span>
<span class="sd">                Measured Current in Amps</span>
<span class="sd">    Ipickup:    float</span>
<span class="sd">                Fault Current Pickup Setting (in Amps)</span>
<span class="sd">    TD:         float</span>
<span class="sd">                Time Dial Setting</span>
<span class="sd">    curve:      string, optional</span>
<span class="sd">                Name of specified TOC curve, may be entry from set:</span>
<span class="sd">                {U1,U2,U3,U4,U5,C1,C2,C3,C4,C5}, default=U1</span>
<span class="sd">    CTR:        float, optional</span>
<span class="sd">                Current Transformer Ratio, default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tt:         float</span>
<span class="sd">                Time-to-Trip for characterized element.</span>
<span class="sd">    """</span>
    <span class="c1"># Condition Inputs</span>
    <span class="n">curve</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="c1"># Define Dictionary of Constants</span>
    <span class="n">const</span> <span class="o">=</span> <span class="p">{</span>   <span class="s2">"U1"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">0.0104</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span> <span class="mf">0.2256</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">},</span>
                <span class="s2">"U2"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">5.95</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span> <span class="mf">0.180</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"U3"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">3.88</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span> <span class="mf">0.0963</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"U4"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">5.67</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span> <span class="mf">0.352</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"U5"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">0.00342</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span> <span class="mf">0.00262</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">},</span>
                <span class="s2">"C1"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">0.14</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">},</span>
                <span class="s2">"C2"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">13.5</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"C3"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">80.0</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"C4"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">120.0</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"C5"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">0.04</span><span class="p">}}</span>
    <span class="c1"># Load Constants</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">const</span><span class="p">[</span><span class="n">curve</span><span class="p">][</span><span class="s2">"A"</span><span class="p">]</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">const</span><span class="p">[</span><span class="n">curve</span><span class="p">][</span><span class="s2">"B"</span><span class="p">]</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">const</span><span class="p">[</span><span class="n">curve</span><span class="p">][</span><span class="s2">"P"</span><span class="p">]</span>
    <span class="c1"># Evaluate M</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">I</span> <span class="o">/</span> <span class="p">(</span><span class="n">CTR</span> <span class="o">*</span> <span class="n">Ipickup</span><span class="p">)</span>
    <span class="c1"># Evaluate Trip Time</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">TD</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">**</span><span class="n">P</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">B</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span></div>

<span class="c1"># Define Time Overcurrent Reset Time Function</span>
<div class="viewcode-block" id="tocreset"><a class="viewcode-back" href="../../api/electricpy.fault.tocreset.html#electricpy.fault.tocreset">[docs]</a><span class="k">def</span> <span class="nf">tocreset</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">Ipickup</span><span class="p">,</span><span class="n">TD</span><span class="p">,</span><span class="n">curve</span><span class="o">=</span><span class="s2">"U1"</span><span class="p">,</span><span class="n">CTR</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Time OverCurrent Reset Time Function.</span>

<span class="sd">    Function to calculate the time to reset for a TOC</span>
<span class="sd">    (Time-OverCurrent, 51) element.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    I:          float</span>
<span class="sd">                Measured Current in Amps</span>
<span class="sd">    Ipickup:    float</span>
<span class="sd">                Fault Current Pickup Setting (in Amps)</span>
<span class="sd">    TD:         float</span>
<span class="sd">                Time Dial Setting</span>
<span class="sd">    curve:      string, optional</span>
<span class="sd">                Name of specified TOC curve, may be entry from set:</span>
<span class="sd">                {U1,U2,U3,U4,U5,C1,C2,C3,C4,C5}, default=U1</span>
<span class="sd">    CTR:        float, optional</span>
<span class="sd">                Current Transformer Ratio, default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tr:         float</span>
<span class="sd">                Time-to-Reset for characterized element.</span>
<span class="sd">    """</span>
    <span class="c1"># Condition Inputs</span>
    <span class="n">curve</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="c1"># Define Dictionary of Constants</span>
    <span class="n">C</span> <span class="o">=</span> <span class="p">{</span>   <span class="s2">"U1"</span> <span class="p">:</span> <span class="mf">1.08</span><span class="p">,</span><span class="s2">"U2"</span> <span class="p">:</span> <span class="mf">5.95</span><span class="p">,</span><span class="s2">"U3"</span> <span class="p">:</span> <span class="mf">3.88</span><span class="p">,</span>
            <span class="s2">"U4"</span> <span class="p">:</span> <span class="mf">5.67</span><span class="p">,</span><span class="s2">"U5"</span> <span class="p">:</span> <span class="mf">0.323</span><span class="p">,</span><span class="s2">"C1"</span> <span class="p">:</span> <span class="mf">13.5</span><span class="p">,</span>
            <span class="s2">"C2"</span> <span class="p">:</span> <span class="mf">47.3</span><span class="p">,</span><span class="s2">"C3"</span> <span class="p">:</span> <span class="mf">80.0</span><span class="p">,</span><span class="s2">"C4"</span> <span class="p">:</span> <span class="mf">120.0</span><span class="p">,</span>
            <span class="s2">"C5"</span> <span class="p">:</span> <span class="mf">4.85</span><span class="p">}</span>
    <span class="c1"># Evaluate M</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">I</span> <span class="o">/</span> <span class="p">(</span><span class="n">CTR</span> <span class="o">*</span> <span class="n">Ipickup</span><span class="p">)</span>
    <span class="c1"># Evaluate Reset Time</span>
    <span class="n">tr</span> <span class="o">=</span> <span class="n">TD</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">curve</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">M</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span></div>

<span class="c1"># Define Pickup Current Calculation</span>
<div class="viewcode-block" id="pickup"><a class="viewcode-back" href="../../api/electricpy.fault.pickup.html#electricpy.fault.pickup">[docs]</a><span class="k">def</span> <span class="nf">pickup</span><span class="p">(</span><span class="n">Iloadmax</span><span class="p">,</span><span class="n">Ifaultmin</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">printout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">units</span><span class="o">=</span><span class="s2">"A"</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Electrical Current Pickup Selection Assistant.</span>

<span class="sd">    Used to assist in evaluating an optimal phase-over-current pickup</span>
<span class="sd">    setting. Uses maximum load and minimum fault current to provide</span>
<span class="sd">    user assistance.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Iloadmax:   float</span>
<span class="sd">                The maximum load current in amps.</span>
<span class="sd">    Ifaultmin:  float</span>
<span class="sd">                The minimum fault current in amps.</span>
<span class="sd">    scale:      int, optional</span>
<span class="sd">                Control scaling to set number of significant figures.</span>
<span class="sd">                default=0</span>
<span class="sd">    printout:   boolean, optional</span>
<span class="sd">                Control argument to enable printing of intermediate</span>
<span class="sd">                stages, default=False.</span>
<span class="sd">    units:      string, optional</span>
<span class="sd">                String to be appended to any printed output denoting</span>
<span class="sd">                the units of which are being printed, default="A"</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    setpoint:   float</span>
<span class="sd">                The evaluated setpoint at which the function suggests</span>
<span class="sd">                the phase-over-current pickup setting be placed.</span>
<span class="sd">    """</span>
    <span class="n">IL2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">Iloadmax</span>
    <span class="n">IF2</span> <span class="o">=</span> <span class="n">Ifaultmin</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">IL2</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">setpoint</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">IL2</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">exponent</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">scale</span><span class="p">))</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">exponent</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">printout</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Range Min:"</span><span class="p">,</span><span class="n">IL2</span><span class="p">,</span><span class="n">units</span><span class="p">,</span><span class="s2">"</span><span class="se">\t\t</span><span class="s2">Range Max:"</span><span class="p">,</span><span class="n">IF2</span><span class="p">,</span><span class="n">units</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">IF2</span> <span class="o">&lt;</span> <span class="n">setpoint</span><span class="p">:</span>
        <span class="n">setpoint</span> <span class="o">=</span> <span class="n">IL2</span>
        <span class="k">if</span> <span class="n">IL2</span> <span class="o">&gt;</span> <span class="n">IF2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Invalid Parameters."</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">printout</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Current Pickup:"</span><span class="p">,</span><span class="n">setpoint</span><span class="p">,</span><span class="n">units</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">setpoint</span><span class="p">)</span></div>

<span class="c1"># Define Time-Dial Coordination Function</span>
<div class="viewcode-block" id="tdradial"><a class="viewcode-back" href="../../api/electricpy.fault.tdradial.html#electricpy.fault.tdradial">[docs]</a><span class="k">def</span> <span class="nf">tdradial</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">CTI</span><span class="p">,</span><span class="n">Ipu_up</span><span class="p">,</span><span class="n">Ipu_dn</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">TDdn</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">curve</span><span class="o">=</span><span class="s2">"U1"</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
                  <span class="n">CTR_up</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">CTR_dn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">tfixed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Radial Time Dial Coordination Function.</span>

<span class="sd">    Function to evaluate the Time-Dial (TD) setting in radial schemes</span>
<span class="sd">    where the Coordinating Time Interval (CTI) and the up/downstream</span>
<span class="sd">    pickup settings are known along with the TD setting for the</span>
<span class="sd">    downstream protection.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    I:          float</span>
<span class="sd">                Measured fault current in Amps, typically set using the</span>
<span class="sd">                maximum fault current available.</span>
<span class="sd">    CTI:        float</span>
<span class="sd">                Coordinating Time Interval in cycles.</span>
<span class="sd">    Ipu_up:     float</span>
<span class="sd">                Pickup setting for upstream protection,</span>
<span class="sd">                specified in amps</span>
<span class="sd">    Ipu_dn:     float, optional</span>
<span class="sd">                Pickup setting for downstream protection,</span>
<span class="sd">                specified in amps, default=0</span>
<span class="sd">    TDdn:       float, optional</span>
<span class="sd">                Time-Dial setting for downstream protection,</span>
<span class="sd">                specified in seconds, default=0</span>
<span class="sd">    curve:      string, optional</span>
<span class="sd">                Name of specified TOC curve, may be entry from set:</span>
<span class="sd">                {U1,U2,U3,U4,U5,C1,C2,C3,C4,C5}, default=U1</span>
<span class="sd">    scale:      int, optional</span>
<span class="sd">                Scaling value used to evaluate a practical TD</span>
<span class="sd">                setting, default=2</span>
<span class="sd">    freq:       float, optional</span>
<span class="sd">                System operating frequency, default=60</span>
<span class="sd">    CTR_up:     float, optional</span>
<span class="sd">                Current Transformer Ratio for upstream relay.</span>
<span class="sd">                default=1</span>
<span class="sd">    CTR_dn:     float, optional</span>
<span class="sd">                Current Transformer Ratio for downstream relay.</span>
<span class="sd">                default=1</span>
<span class="sd">    tfixed:     float, optional</span>
<span class="sd">                Used to specify a fixed time delay for coordinated</span>
<span class="sd">                protection elements, primarily used for coordinating</span>
<span class="sd">                TOC elements (51) with OC elements (50) with a fixed</span>
<span class="sd">                tripping time. Overrides downstream TOC arguments</span>
<span class="sd">                including *Ipu_dn* and *TDdn*.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    TD:         float</span>
<span class="sd">                Calculated Time-Dial setting according to radial</span>
<span class="sd">                scheme logical analysis.</span>
<span class="sd">    """</span>
    <span class="c1"># Condition Inputs</span>
    <span class="n">curve</span> <span class="o">=</span> <span class="n">curve</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="c1"># Define Dictionary of Constants</span>
    <span class="n">const</span> <span class="o">=</span> <span class="p">{</span>   <span class="s2">"U1"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">0.0104</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span> <span class="mf">0.2256</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">},</span>
                <span class="s2">"U2"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">5.95</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span> <span class="mf">0.180</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"U3"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">3.88</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span> <span class="mf">0.0963</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"U4"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">5.67</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span> <span class="mf">0.352</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"U5"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">0.00342</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span> <span class="mf">0.00262</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">},</span>
                <span class="s2">"C1"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">0.14</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">},</span>
                <span class="s2">"C2"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">13.5</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"C3"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">80.0</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"C4"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">120.0</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">},</span>
                <span class="s2">"C5"</span> <span class="p">:</span> <span class="p">{</span><span class="s2">"A"</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">:</span> <span class="mf">0.04</span><span class="p">}}</span>
    <span class="c1"># Load Constants</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">const</span><span class="p">[</span><span class="n">curve</span><span class="p">][</span><span class="s2">"A"</span><span class="p">]</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">const</span><span class="p">[</span><span class="n">curve</span><span class="p">][</span><span class="s2">"B"</span><span class="p">]</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">const</span><span class="p">[</span><span class="n">curve</span><span class="p">][</span><span class="s2">"P"</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">tfixed</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Evaluate in seconds from cycles</span>
        <span class="n">CTI</span> <span class="o">=</span> <span class="n">CTI</span><span class="o">/</span><span class="n">freq</span>
        <span class="c1"># Evaluate M</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">I</span> <span class="o">/</span> <span class="p">(</span><span class="n">CTR_dn</span> <span class="o">*</span> <span class="n">Ipu_dn</span><span class="p">)</span>
        <span class="c1"># Evaluate Trip Time</span>
        <span class="n">tpu_desired</span> <span class="o">=</span> <span class="n">TDdn</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">**</span><span class="n">P</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="n">CTI</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tpu_desired</span> <span class="o">=</span> <span class="n">tfixed</span> <span class="o">+</span> <span class="n">CTI</span>
    <span class="c1"># Re-Evaluate M</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">I</span> <span class="o">/</span> <span class="p">(</span><span class="n">CTR_up</span> <span class="o">*</span> <span class="n">Ipu_up</span><span class="p">)</span>
    <span class="c1"># Calculate TD setting</span>
    <span class="n">TD</span> <span class="o">=</span> <span class="n">tpu_desired</span> <span class="o">/</span> <span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">B</span><span class="p">)</span>
    <span class="c1"># Scale and Round</span>
    <span class="n">TD</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">TD</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">scale</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="o">**</span><span class="n">scale</span>
    <span class="k">return</span><span class="p">(</span><span class="n">TD</span><span class="p">)</span></div>

<span class="c1"># Define TAP Calculator</span>
<div class="viewcode-block" id="protectiontap"><a class="viewcode-back" href="../../api/electricpy.fault.protectiontap.html#electricpy.fault.protectiontap">[docs]</a><span class="k">def</span> <span class="nf">protectiontap</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">CTR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VLN</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">VLL</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Protection TAP Setting Calculator.</span>

<span class="sd">    Evaluates the required TAP setting based on the rated power of</span>
<span class="sd">    a transformer (the object being protected) and the voltage</span>
<span class="sd">    (either primary or secondary) in conjunction with the CTR</span>
<span class="sd">    (current transformer ratio) for the side in question (primary/</span>
<span class="sd">    secondary).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    CTR:        float</span>
<span class="sd">                The Current Transformer Ratio.</span>
<span class="sd">    S:          float</span>
<span class="sd">                Rated apparent power magnitude (VA/VAR/W).</span>
<span class="sd">    VLN:        float, exclusive</span>
<span class="sd">                Line-to-Neutral voltage in volts.</span>
<span class="sd">    VLL:        float, exclusive</span>
<span class="sd">                Line-to-Line voltage in volts.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    TAP:        float</span>
<span class="sd">                The TAP setting required to meet the specifications.</span>
<span class="sd">    """</span>
    <span class="c1"># Condition Voltage(s)</span>
    <span class="k">if</span> <span class="n">VLL</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">V</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">VLL</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">VLN</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">V</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">VLN</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"One or more voltages must be provided."</span><span class="p">)</span>
    <span class="c1"># Calculate TAP</span>
    <span class="n">TAP</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="n">CTR</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">TAP</span><span class="p">)</span></div>



<span class="c1"># Define Current Correction Calculator</span>
<div class="viewcode-block" id="correctedcurrents"><a class="viewcode-back" href="../../api/electricpy.fault.correctedcurrents.html#electricpy.fault.correctedcurrents">[docs]</a><span class="k">def</span> <span class="nf">correctedcurrents</span><span class="p">(</span><span class="n">Ipri</span><span class="p">,</span><span class="n">TAP</span><span class="p">,</span><span class="n">correction</span><span class="o">=</span><span class="s2">"Y"</span><span class="p">,</span><span class="n">CTR</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Electrical Transformer Current Correction Function.</span>

<span class="sd">    Function to evaluate the currents as corrected for microprocessor-</span>
<span class="sd">    based relay protection schemes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Ipri:       list of complex</span>
<span class="sd">                Three-phase set (IA, IB, IC) of primary currents.</span>
<span class="sd">    TAP:        float</span>
<span class="sd">                Relay's TAP setting.</span>
<span class="sd">    correction: string, optional</span>
<span class="sd">                String defining correction factor, may be one of:</span>
<span class="sd">                (Y, D+, D-, Z); Y denotes Y (Y0) connection, D+</span>
<span class="sd">                denotes Dab (D1) connection, D- denotes Dac (D11)</span>
<span class="sd">                connection, and Z (Z12) denotes zero-sequence</span>
<span class="sd">                removal. default="Y"</span>
<span class="sd">    CTR:        float</span>
<span class="sd">                Current Transformer Ratio, default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Isec_corr:  list of complex</span>
<span class="sd">                The corrected currents to perform operate/restraint</span>
<span class="sd">                calculations with.</span>
<span class="sd">    """</span>
    <span class="c1"># Define Matrix Lookup</span>
    <span class="n">MAT</span> <span class="o">=</span> <span class="p">{</span>   <span class="s2">"Y"</span>  <span class="p">:</span> <span class="n">XFMY0</span><span class="p">,</span>
              <span class="s2">"D+"</span> <span class="p">:</span> <span class="n">XFMD1</span><span class="p">,</span>
              <span class="s2">"D-"</span> <span class="p">:</span> <span class="n">XFMD11</span><span class="p">,</span>
              <span class="s2">"Z"</span>  <span class="p">:</span> <span class="n">XFM12</span><span class="p">}</span>
    <span class="c1"># Condition Inputs</span>
    <span class="n">Ipri</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Ipri</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">correction</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
        <span class="n">mult</span> <span class="o">=</span> <span class="n">MAT</span><span class="p">[</span><span class="n">correction</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">correction</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">mult</span> <span class="o">=</span> <span class="n">mult</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">MAT</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">correction</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
        <span class="n">mult</span> <span class="o">=</span> <span class="n">MAT</span><span class="p">[</span><span class="n">correction</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">correction</span><span class="p">,</span><span class="n">_np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">mult</span> <span class="o">=</span> <span class="n">correction</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Correction must be string or list of strings."</span><span class="p">)</span>
    <span class="c1"># Evaluate Corrected Current</span>
    <span class="n">Isec_corr</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">TAP</span> <span class="o">*</span> <span class="n">mult</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ipri</span><span class="o">/</span><span class="n">CTR</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Isec_corr</span><span class="p">)</span></div>



<span class="c1"># Define Iop/Irt Calculator</span>
<div class="viewcode-block" id="iopirt"><a class="viewcode-back" href="../../api/electricpy.fault.iopirt.html#electricpy.fault.iopirt">[docs]</a><span class="k">def</span> <span class="nf">iopirt</span><span class="p">(</span><span class="n">IpriHV</span><span class="p">,</span><span class="n">IpriLV</span><span class="p">,</span><span class="n">TAPHV</span><span class="p">,</span><span class="n">TAPLV</span><span class="p">,</span><span class="n">corrHV</span><span class="o">=</span><span class="s2">"Y"</span><span class="p">,</span><span class="n">corrLV</span><span class="o">=</span><span class="s2">"Y"</span><span class="p">,</span><span class="n">CTRHV</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">CTRLV</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Operate/Restraint Current Calculator.</span>

<span class="sd">    Calculates the operating current (Iop) and the restraint</span>
<span class="sd">    current (Irt) as well as the slope.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    IpriHV:     list of complex</span>
<span class="sd">                Three-phase set (IA, IB, IC) of primary currents</span>
<span class="sd">                on the high-voltage side of power transformer.</span>
<span class="sd">    IpriLV      list of complex</span>
<span class="sd">                Three-phase set (IA, IB, IC) of primary currents</span>
<span class="sd">                on the low-voltage side of power transformer.</span>
<span class="sd">    TAPHV       float</span>
<span class="sd">                Relay's TAP setting for high-voltage side of</span>
<span class="sd">                power transformer.</span>
<span class="sd">    TAPLV       float</span>
<span class="sd">                Relay's TAP setting for low-voltage side of</span>
<span class="sd">                power transformer.</span>
<span class="sd">    corrHV      string, optional</span>
<span class="sd">                String defining correction factor on high-voltage</span>
<span class="sd">                side of power transformer, may be one of:</span>
<span class="sd">                (Y, D+, D-, Z); Y denotes Y (Y0) connection, D+</span>
<span class="sd">                denotes Dab (D1) connection, D- denotes Dac (D11)</span>
<span class="sd">                connection, and Z (Z12) denotes zero-sequence</span>
<span class="sd">                removal. default="Y"</span>
<span class="sd">    corrLV      string, optional</span>
<span class="sd">                String defining correction factor on low-voltage</span>
<span class="sd">                side of power transformer, may be one of:</span>
<span class="sd">                (Y, D+, D-, Z); Y denotes Y (Y0) connection, D+</span>
<span class="sd">                denotes Dab (D1) connection, D- denotes Dac (D11)</span>
<span class="sd">                connection, and Z (Z12) denotes zero-sequence</span>
<span class="sd">                removal. default="Y"</span>
<span class="sd">    CTRHV       float</span>
<span class="sd">                Current Transformer Ratio for high-voltage side</span>
<span class="sd">                of power transformer, default=1</span>
<span class="sd">    CTRLV       float</span>
<span class="sd">                Current Transformer Ratio for low-voltage side</span>
<span class="sd">                of power transformer, default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Iop:        list of float</span>
<span class="sd">                The operating currents for phases A, B, and C.</span>
<span class="sd">    Irt:        list of float</span>
<span class="sd">                The restraint currents for phases A, B, and C.</span>
<span class="sd">    slope:      list of float</span>
<span class="sd">                The calculated slopes for phases A, B, and C.</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate Corrected Currents</span>
    <span class="n">IcorHV</span> <span class="o">=</span> <span class="n">correctedcurrents</span><span class="p">(</span><span class="n">IpriHV</span><span class="p">,</span><span class="n">TAPHV</span><span class="p">,</span><span class="n">corrHV</span><span class="p">,</span><span class="n">CTRHV</span><span class="p">)</span>
    <span class="n">IcorLV</span> <span class="o">=</span> <span class="n">correctedcurrents</span><span class="p">(</span><span class="n">IpriLV</span><span class="p">,</span><span class="n">TAPLV</span><span class="p">,</span><span class="n">corrLV</span><span class="p">,</span><span class="n">CTRLV</span><span class="p">)</span>
    <span class="c1"># Calculate Operate/Restraint Currents</span>
    <span class="n">Iop</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span> <span class="n">IcorHV</span> <span class="o">+</span> <span class="n">IcorLV</span> <span class="p">)</span>
    <span class="n">Irt</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">IcorHV</span><span class="p">)</span> <span class="o">+</span> <span class="n">_np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">IcorLV</span><span class="p">)</span>
    <span class="c1"># Calculate Slopes</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">Iop</span><span class="o">/</span><span class="n">Irt</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Iop</span><span class="p">,</span><span class="n">Irt</span><span class="p">,</span><span class="n">slope</span><span class="p">)</span></div>

<span class="c1"># Define Symmetrical/RMS Current Calculation</span>
<div class="viewcode-block" id="symrmsfaultcur"><a class="viewcode-back" href="../../api/electricpy.fault.symrmsfaultcur.html#electricpy.fault.symrmsfaultcur">[docs]</a><span class="k">def</span> <span class="nf">symrmsfaultcur</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Symmetrical/RMS Current Calculator.</span>

<span class="sd">    Function to evaluate the time-constant tau, the symmetrical fault current,</span>
<span class="sd">    and the RMS current for a faulted circuit.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    V:          float</span>
<span class="sd">                Voltage magnitude at fault point,</span>
<span class="sd">                not described as line-to-line or</span>
<span class="sd">                line-to-neutral.</span>
<span class="sd">    R:          float</span>
<span class="sd">                The fault resistance in ohms.</span>
<span class="sd">    X:          float</span>
<span class="sd">                The fault impedance in ohms.</span>
<span class="sd">    t:          float, optional</span>
<span class="sd">                The time in seconds.</span>
<span class="sd">    freq:       float, optional</span>
<span class="sd">                The system frequency in Hz.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tau:        float</span>
<span class="sd">                The time-constant tau in seconds.</span>
<span class="sd">    Isym:       float</span>
<span class="sd">                Symmetrical fault current in amps.</span>
<span class="sd">    Irms:       float</span>
<span class="sd">                RMS fault current in amps.</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate Z and tau</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="n">X</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">R</span><span class="p">)</span>
    <span class="c1"># Calculate Symmetrical Fault Current</span>
    <span class="n">Isym</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span><span class="o">/</span><span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="n">Z</span>
    <span class="c1"># Calculate RMS Fault Current</span>
    <span class="n">Irms</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">))</span><span class="o">*</span><span class="n">Isym</span>
    <span class="k">return</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span><span class="n">Isym</span><span class="p">,</span><span class="n">Irms</span><span class="p">)</span></div>

<span class="c1"># Define Relay M Formula</span>
<div class="viewcode-block" id="faultratio"><a class="viewcode-back" href="../../api/electricpy.fault.faultratio.html#electricpy.fault.faultratio">[docs]</a><span class="k">def</span> <span class="nf">faultratio</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">Ipickup</span><span class="p">,</span><span class="n">CTR</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Fault Multiple of Pickup (Ratio) Calculator.</span>

<span class="sd">    Evaluates the CTR-scaled pickup measured to pickup current ratio.</span>

<span class="sd">    M = meas / pickup</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    I:          float</span>
<span class="sd">                Measured Current in Amps</span>
<span class="sd">    Ipickup:    float</span>
<span class="sd">                Fault Current Pickup Setting (in Amps)</span>
<span class="sd">    CTR:        float, optional</span>
<span class="sd">                Current Transformer Ratio for relay,</span>
<span class="sd">                default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    M:          float</span>
<span class="sd">                The measured-to-pickup ratio</span>
<span class="sd">    """</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">I</span><span class="o">/</span><span class="p">(</span><span class="n">CTR</span> <span class="o">*</span> <span class="n">Ipickup</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">M</span><span class="p">)</span></div>

<span class="c1"># Define Residual Compensation Factor Function</span>
<div class="viewcode-block" id="residcomp"><a class="viewcode-back" href="../../api/electricpy.fault.residcomp.html#electricpy.fault.residcomp">[docs]</a><span class="k">def</span> <span class="nf">residcomp</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">linelength</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Residual Compensation Factor Function.</span>

<span class="sd">    Evaluates the residual compensation factor based on the line's positive and</span>
<span class="sd">    zero sequence impedance characteristics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    z1:         complex</span>
<span class="sd">                The positive-sequence impedance</span>
<span class="sd">                characteristic of the line, specified in</span>
<span class="sd">                ohms-per-unit where the total line length</span>
<span class="sd">                (of same unit) is specified in</span>
<span class="sd">                *linelength* argument.</span>
<span class="sd">    z0:         complex</span>
<span class="sd">                The zero-sequence impedance characteristic</span>
<span class="sd">                of the line, specified in ohms-per-unit</span>
<span class="sd">                where the total line length (of same unit)</span>
<span class="sd">                is specified in *linelength* argument.</span>
<span class="sd">    linelength: float, optional</span>
<span class="sd">                The length (in same base unit as impedance</span>
<span class="sd">                characteristics) of the line. default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    k0:         complex</span>
<span class="sd">                The residual compensation factor.</span>
<span class="sd">    """</span>
    <span class="c1"># Evaluate Z1L and Z0L</span>
    <span class="n">Z1L</span> <span class="o">=</span> <span class="n">z1</span><span class="o">*</span><span class="n">linelength</span>
    <span class="n">Z0L</span> <span class="o">=</span> <span class="n">z0</span><span class="o">*</span><span class="n">linelength</span>
    <span class="c1"># Calculate Residual Compensation Factor (k0)</span>
    <span class="n">k0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Z0L</span> <span class="o">-</span> <span class="n">Z1L</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">Z1L</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">k0</span><span class="p">)</span></div>

<span class="c1"># Define Relay Measured Impedance Functon for Distance Elements</span>
<div class="viewcode-block" id="distmeasz"><a class="viewcode-back" href="../../api/electricpy.fault.distmeasz.html#electricpy.fault.distmeasz">[docs]</a><span class="k">def</span> <span class="nf">distmeasz</span><span class="p">(</span><span class="n">VLNmeas</span><span class="p">,</span><span class="n">If</span><span class="p">,</span><span class="n">Ip</span><span class="p">,</span><span class="n">Ipp</span><span class="p">,</span><span class="n">CTR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VTR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">k0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">z1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">z0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">linelength</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Distance Element Measured Impedance Function.</span>

<span class="sd">    Function to evaluate the Relay-Measured-Impedance as calculated from</span>
<span class="sd">    the measured voltage, current, and line parameters.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    VLNmeas:    complex</span>
<span class="sd">                Measured Line-to-Neutral voltage for the</span>
<span class="sd">                faulted phase in primary volts.</span>
<span class="sd">    If:         complex</span>
<span class="sd">                Faulted phase current measured in primary</span>
<span class="sd">                amps.</span>
<span class="sd">    Ip:         complex</span>
<span class="sd">                Secondary phase current measured in primary</span>
<span class="sd">                amps.</span>
<span class="sd">    Ipp:        complex</span>
<span class="sd">                Terchiary phase current measured in primary</span>
<span class="sd">                amps.</span>
<span class="sd">    CTR:        float, optional</span>
<span class="sd">                Current transformer ratio, default=1</span>
<span class="sd">    VTR:        float, optional</span>
<span class="sd">                Voltage transformer ratio, default=1</span>
<span class="sd">    k0:         complex, optional</span>
<span class="sd">                Residual Compensation Factor</span>
<span class="sd">    z1:         complex, optional</span>
<span class="sd">                The positive-sequence impedance</span>
<span class="sd">                characteristic of the line, specified in</span>
<span class="sd">                ohms-per-unit where the total line length</span>
<span class="sd">                (of same unit) is specified in</span>
<span class="sd">                *linelength* argument.</span>
<span class="sd">    z0:         complex, optional</span>
<span class="sd">                The zero-sequence impedance characteristic</span>
<span class="sd">                of the line, specified in ohms-per-unit</span>
<span class="sd">                where the total line length (of same unit)</span>
<span class="sd">                is specified in *linelength* argument.</span>
<span class="sd">    linelength: float, optional</span>
<span class="sd">                The length (in same base unit as impedance</span>
<span class="sd">                characteristics) of the line. default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Zmeas:      complex</span>
<span class="sd">                The "measured" impedance as calculated by the relay.</span>
<span class="sd">    """</span>
    <span class="c1"># Validate Residual Compensation Inputs</span>
    <span class="k">if</span> <span class="n">k0</span> <span class="o">==</span> <span class="n">z1</span> <span class="o">==</span> <span class="n">z0</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Residual compensation arguments must be set."</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k0</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">z1</span><span class="o">==</span><span class="kc">None</span> <span class="ow">or</span> <span class="n">z0</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Both *z1* and *z0* must be specified."</span><span class="p">)</span>
    <span class="c1"># Calculate Residual Compensation if Necessary</span>
    <span class="k">if</span> <span class="n">k0</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">k0</span> <span class="o">=</span> <span class="n">residcomp</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span><span class="n">z0</span><span class="p">,</span><span class="n">linelength</span><span class="p">)</span>
    <span class="c1"># Convert Primary Units to Secondary</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">VLNmeas</span><span class="o">/</span><span class="n">VTR</span>
    <span class="n">Ir</span> <span class="o">=</span> <span class="p">(</span><span class="n">If</span> <span class="o">+</span> <span class="n">Ip</span> <span class="o">+</span> <span class="n">Ipp</span><span class="p">)</span><span class="o">/</span><span class="n">CTR</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">If</span><span class="o">/</span><span class="n">CTR</span>
    <span class="c1"># Calculate Measured Impedance</span>
    <span class="n">Zmeas</span> <span class="o">=</span> <span class="n">V</span> <span class="o">/</span> <span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="n">k0</span><span class="o">*</span><span class="n">Ir</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Zmeas</span><span class="p">)</span></div>

<span class="c1"># Define Transformer Tap Mismatch Function</span>
<div class="viewcode-block" id="transmismatch"><a class="viewcode-back" href="../../api/electricpy.fault.transmismatch.html#electricpy.fault.transmismatch">[docs]</a><span class="k">def</span> <span class="nf">transmismatch</span><span class="p">(</span><span class="n">I1</span><span class="p">,</span><span class="n">I2</span><span class="p">,</span><span class="n">tap1</span><span class="p">,</span><span class="n">tap2</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Electrical Transformer TAP Mismatch Function.</span>

<span class="sd">    Function to evaluate the transformer ratio mismatch for protection.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    I1:         complex</span>
<span class="sd">                Current (in amps) on transformer primary side.</span>
<span class="sd">    I2:         complex</span>
<span class="sd">                Current (in amps) on transformer secondary.</span>
<span class="sd">    tap1:       float</span>
<span class="sd">                Relay TAP setting on the primary side.</span>
<span class="sd">    tap2:       float</span>
<span class="sd">                Relay TAP setting on the secondary side.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mismatch:   float</span>
<span class="sd">                Transformer CT mismatch value associated with</span>
<span class="sd">                relay.</span>
<span class="sd">    """</span>
    <span class="c1"># Evaluate MR</span>
    <span class="n">MR</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">I1</span><span class="o">/</span><span class="n">I2</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tap1</span><span class="o">/</span><span class="n">tap2</span><span class="p">)</span> <span class="p">)</span>
    <span class="c1"># Calculate Mismatch</span>
    <span class="n">mismatch</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">I1</span><span class="o">/</span><span class="n">I2</span><span class="p">)</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tap1</span><span class="o">/</span><span class="n">tap2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">MR</span>
    <span class="k">return</span><span class="p">(</span><span class="n">mismatch</span><span class="p">)</span></div>

<span class="c1"># Define High-Impedance Bus Protection Pickup Function</span>
<div class="viewcode-block" id="highzvpickup"><a class="viewcode-back" href="../../api/electricpy.fault.highzvpickup.html#electricpy.fault.highzvpickup">[docs]</a><span class="k">def</span> <span class="nf">highzvpickup</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">RL</span><span class="p">,</span><span class="n">Rct</span><span class="p">,</span><span class="n">CTR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">threephase</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Ks</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                 <span class="n">Vstd</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">Kd</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    High Impedance Pickup Setting Function.</span>

<span class="sd">    Evaluates the voltage pickup setting for a high</span>
<span class="sd">    impedance bus protection system.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    I:          float</span>
<span class="sd">                Fault current on primary side (in amps)</span>
<span class="sd">    RL:         float</span>
<span class="sd">                One-way line resistance in ohms</span>
<span class="sd">    Rct:        float</span>
<span class="sd">                Current Transformer Resistance in ohms</span>
<span class="sd">    CTR:        float, optional</span>
<span class="sd">                Current Transformer Ratio, default=1</span>
<span class="sd">    threephase: bool, optional</span>
<span class="sd">                Control argument to set the function to</span>
<span class="sd">                evaluate the result for a three-phase</span>
<span class="sd">                fault or unbalanced fault. default=False</span>
<span class="sd">    Ks:         float, optional</span>
<span class="sd">                Security Factor for secure voltage pickup</span>
<span class="sd">                setting, default=1.5</span>
<span class="sd">    Vstd:       float, optional</span>
<span class="sd">                C-Class Voltage rating (i.e. C-400),</span>
<span class="sd">                default=400</span>
<span class="sd">    Kd:         float, optional</span>
<span class="sd">                The dependability factor for dependable</span>
<span class="sd">                voltage pickup setting, default=0.5</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Vsens:      float</span>
<span class="sd">                The calculated sensetive voltage-pickup.</span>
<span class="sd">    Vdep:       float</span>
<span class="sd">                The calculated dependable voltage-pickup.</span>
<span class="sd">    """</span>
    <span class="c1"># Condition Based on threephase Argument</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">threephase</span><span class="p">:</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># Evaluate Secure Voltage Pickup</span>
    <span class="n">Vsens</span> <span class="o">=</span> <span class="n">Ks</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">RL</span><span class="o">+</span><span class="n">Rct</span><span class="p">)</span><span class="o">*</span><span class="n">I</span><span class="o">/</span><span class="n">CTR</span>
    <span class="c1"># Evaluate Dependible Voltage Pickup</span>
    <span class="n">Vdep</span> <span class="o">=</span> <span class="n">Kd</span><span class="o">*</span><span class="n">Vstd</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Vsens</span><span class="p">,</span><span class="n">Vdep</span><span class="p">)</span></div>

<span class="c1"># Define Minimum Current Pickup for High-Impedance Bus Protection</span>
<div class="viewcode-block" id="highzmini"><a class="viewcode-back" href="../../api/electricpy.fault.highzmini.html#electricpy.fault.highzmini">[docs]</a><span class="k">def</span> <span class="nf">highzmini</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Ie</span><span class="p">,</span><span class="n">Irly</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Vset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Rrly</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="n">Imov</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">CTR</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Minimum Current for High Impedance Protection Calculator.</span>

<span class="sd">    Evaluates the minimum pickup current required to cause</span>
<span class="sd">    high-impedance bus protection element pickup.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N:          int</span>
<span class="sd">                Number of Current Transformers included in scheme</span>
<span class="sd">    Ie:         float</span>
<span class="sd">                The excitation current at the voltage setting</span>
<span class="sd">    Irly:       float, optional</span>
<span class="sd">                The relay current at voltage setting</span>
<span class="sd">    Vset:       float, optional</span>
<span class="sd">                The relay's voltage pickup setting in volts.</span>
<span class="sd">    Rrly:       float, optional</span>
<span class="sd">                The relay's internal resistance in ohms, default=2000</span>
<span class="sd">    Imov:       float, optional</span>
<span class="sd">                The overvoltage protection current at the</span>
<span class="sd">                voltage setting. default=0.0</span>
<span class="sd">    CTR:        float, optional</span>
<span class="sd">                Current Transformer Ratio, default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Imin:       float</span>
<span class="sd">                Minimum current required to cause high-impedance</span>
<span class="sd">                bus protection element pickup.</span>
<span class="sd">    """</span>
    <span class="c1"># Validate Inputs</span>
    <span class="k">if</span> <span class="n">Irly</span> <span class="o">==</span> <span class="n">Vset</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Relay Current Required."</span><span class="p">)</span>
    <span class="c1"># Condition Inputs</span>
    <span class="n">Ie</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Ie</span><span class="p">)</span>
    <span class="n">Imov</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Imov</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Irly</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Vset</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Vset</span><span class="p">)</span>
        <span class="n">Irly</span> <span class="o">=</span> <span class="n">Vset</span> <span class="o">/</span> <span class="n">Rrly</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Irly</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Irly</span><span class="p">)</span>
    <span class="c1"># Evaluate Minimum Current Pickup</span>
    <span class="n">Imin</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">Ie</span><span class="o">+</span><span class="n">Irly</span><span class="o">+</span><span class="n">Imov</span><span class="p">)</span><span class="o">*</span><span class="n">CTR</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Imin</span><span class="p">)</span></div>

<span class="c1"># Define Instantaneous Overcurrent Pickup Formula</span>
<div class="viewcode-block" id="instoc"><a class="viewcode-back" href="../../api/electricpy.fault.instoc.html#electricpy.fault.instoc">[docs]</a><span class="k">def</span> <span class="nf">instoc</span><span class="p">(</span><span class="n">Imin</span><span class="p">,</span><span class="n">CTR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Ki</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Instantaneous OverCurrent Pickup Calculator.</span>

<span class="sd">    Using a sensetivity factor and the CTR, evaluates the secondary-level pickup</span>
<span class="sd">    setting for an instantaneous overcurrent element.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Imin:       float</span>
<span class="sd">                The minimum fault current in primary amps.</span>
<span class="sd">    CTR:        float, optional</span>
<span class="sd">                Current Transformer Ratio, default=1</span>
<span class="sd">    Ki:         Sensetivity factor, default=0.5</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Ipu:        float</span>
<span class="sd">                The pickup setting for the instantaneous</span>
<span class="sd">                overcurrent element as referred to the</span>
<span class="sd">                secondary side.</span>
<span class="sd">    """</span>
    <span class="c1"># Evaluate Overcurrent Pickup Setting</span>
    <span class="n">Ipu</span> <span class="o">=</span> <span class="n">Ki</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Imin</span><span class="p">)</span><span class="o">/</span><span class="n">CTR</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Ipu</span><span class="p">)</span></div>

<span class="c1"># Define Generator Loss of Field Element Function</span>
<div class="viewcode-block" id="genlossfield"><a class="viewcode-back" href="../../api/electricpy.fault.genlossfield.html#electricpy.fault.genlossfield">[docs]</a><span class="k">def</span> <span class="nf">genlossfield</span><span class="p">(</span><span class="n">Xd</span><span class="p">,</span><span class="n">Xpd</span><span class="p">,</span><span class="n">Zbase</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">CTR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">VTR</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Electric Generator Loss of Field Function.</span>

<span class="sd">    Generates the Loss-of-Field Element settings for a generator using the Xd</span>
<span class="sd">    value and per-unit base information.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Xd:         float</span>
<span class="sd">                The Transient Reactance (Xd) term. May be</span>
<span class="sd">                specified in ohms or Per-Unit ohms if</span>
<span class="sd">                *Zbase* is set.</span>
<span class="sd">    Xpd:        float</span>
<span class="sd">                The Sub-Transient Reactance (X'd) term. May</span>
<span class="sd">                be specified in ohms or Per-Unit ohms if</span>
<span class="sd">                *Zbase* is set.</span>
<span class="sd">    Zbase:      float, optional</span>
<span class="sd">                Base impedance, used to convert per-unit</span>
<span class="sd">                Xd and Xpd to secondary values. default=1</span>
<span class="sd">    CTR:        float, optional</span>
<span class="sd">                Current Transformer Ratio, default=1</span>
<span class="sd">    VTR:        float, optional</span>
<span class="sd">                Voltage Transformer Ratio, default=1</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ZoneOff:    float</span>
<span class="sd">                Zone Offset in ohms.</span>
<span class="sd">    Z1dia:      float</span>
<span class="sd">                Zone 1 diameter in ohms.</span>
<span class="sd">    Z2dia:      float</span>
<span class="sd">                Zone 2 diameter in ohms.</span>
<span class="sd">    """</span>
    <span class="c1"># Condition Inputs</span>
    <span class="n">Xd</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Xd</span><span class="p">)</span>
    <span class="n">Xpd</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Xpd</span><span class="p">)</span>
    <span class="n">Zbase</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Zbase</span><span class="p">)</span>
    <span class="c1"># Evaluate Xd_sec and Xpd_sec</span>
    <span class="n">Xd_sec</span> <span class="o">=</span> <span class="n">Xd</span><span class="o">*</span><span class="n">Zbase</span><span class="o">*</span><span class="p">(</span><span class="n">CTR</span><span class="o">/</span><span class="n">VTR</span><span class="p">)</span>
    <span class="n">Xpd_sec</span> <span class="o">=</span> <span class="n">Xd</span><span class="o">*</span><span class="n">Zbase</span><span class="o">*</span><span class="p">(</span><span class="n">CTR</span><span class="o">/</span><span class="n">VTR</span><span class="p">)</span>
    <span class="c1"># Determine Zone Offset</span>
    <span class="n">ZoneOff</span> <span class="o">=</span> <span class="n">Xpd_sec</span><span class="o">/</span><span class="mi">2</span>
    <span class="c1"># Evaluate Z1 Diameter and Z2 Diameter</span>
    <span class="n">Z1dia</span> <span class="o">=</span> <span class="n">Zbase</span><span class="o">*</span><span class="n">CTR</span><span class="o">/</span><span class="n">VTR</span>
    <span class="n">Z2dia</span> <span class="o">=</span> <span class="n">Xd_sec</span>
    <span class="c1"># Return</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ZoneOff</span><span class="p">,</span><span class="n">Z1dia</span><span class="p">,</span><span class="n">Z2dia</span><span class="p">)</span></div>

<span class="c1"># Define Thermal Time Limit Calculator</span>
<div class="viewcode-block" id="thermaltime"><a class="viewcode-back" href="../../api/electricpy.fault.thermaltime.html#electricpy.fault.thermaltime">[docs]</a><span class="k">def</span> <span class="nf">thermaltime</span><span class="p">(</span><span class="n">In</span><span class="p">,</span><span class="n">Ibase</span><span class="p">,</span><span class="n">tbase</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Thermal Time Limit Calculator.</span>

<span class="sd">    Computes the maximum allowable time for a specified current `In` given</span>
<span class="sd">    parameters for a maximum current and time at some other level, (`Ibase`,</span>
<span class="sd">    `tbase`).</span>

<span class="sd">    Uses the following formula:</span>

<span class="sd">    .. math:: t_n=\frac{I_{base}^2*t_{base}}{I_n^2}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    In:         float</span>
<span class="sd">                Current at which to calculate max time.</span>
<span class="sd">    Ibase:      float</span>
<span class="sd">                Base current, at which maximum time</span>
<span class="sd">                `tbase` is allowable.</span>
<span class="sd">    tbase:      float</span>
<span class="sd">                Base time for which a maximum allowable</span>
<span class="sd">                current `Ibase` is specified. Unitless.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tn:         float</span>
<span class="sd">                Time allowable for specified current,</span>
<span class="sd">                `In`.</span>
<span class="sd">    """</span>
    <span class="c1"># Perform Calculation</span>
    <span class="n">tn</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ibase</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">tbase</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">In</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">tn</span><span class="p">)</span></div>


<span class="c1"># Define Synch. Machine Fault Current Calculator</span>
<div class="viewcode-block" id="synmach_Isym"><a class="viewcode-back" href="../../api/electricpy.fault.synmach_Isym.html#electricpy.fault.synmach_Isym">[docs]</a><span class="k">def</span> <span class="nf">synmach_Isym</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Eq</span><span class="p">,</span><span class="n">Xd</span><span class="p">,</span><span class="n">Xdp</span><span class="p">,</span><span class="n">Xdpp</span><span class="p">,</span><span class="n">Tdp</span><span class="p">,</span><span class="n">Tdpp</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Synch. Machine Symmetrical Fault Current Calc.</span>

<span class="sd">    Determines the Symmetrical Fault Current of a synchronous</span>
<span class="sd">    machine given the machine parameters, the internal voltage,</span>
<span class="sd">    and the time for which to calculate.</span>

<span class="sd">    .. math:: I_a(t)=\sqrt{2}\left|E_q\right|\left[</span>
<span class="sd">       \frac{1}{X_d}+\left(\frac{1}{X'_d}-\frac{1}{X_d}</span>
<span class="sd">       \right)\cdot e^{\frac{-t}{T'_d}}+\left(\frac{1}</span>
<span class="sd">       {X"_d}-\frac{1}{X'_d}\right)\cdot e^{\frac{-t}{T"_d}}</span>
<span class="sd">       \right]</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t:          float</span>
<span class="sd">                Time at which to calculate the fault current</span>
<span class="sd">    Eq:         float</span>
<span class="sd">                The internal machine voltage in per-unit-volts</span>
<span class="sd">    Xd:         float</span>
<span class="sd">                The Xd (d-axis) reactance in per-unit-ohms</span>
<span class="sd">    Xdp:        float</span>
<span class="sd">                The X"d (d-axis transient) reactance in</span>
<span class="sd">                per-unit-ohms</span>
<span class="sd">    Xdpp:       float</span>
<span class="sd">                The X"d (d-axis subtransient) reactance in</span>
<span class="sd">                per-unit-ohms</span>
<span class="sd">    Tdp:        float</span>
<span class="sd">                The T'd (d-axis transient) time constant of the</span>
<span class="sd">                machine in seconds</span>
<span class="sd">    Tdpp:       float</span>
<span class="sd">                The T"d (d-axis subtransient) time constant of</span>
<span class="sd">                the machine in seconds</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Ia:         float</span>
<span class="sd">                Peak symmetrical fault current in per-unit-amps</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate Time-Constant Term</span>
    <span class="n">t_c</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">Xd</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Xdp</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">Xd</span><span class="p">)</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">Tdp</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Xdpp</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">Xdp</span><span class="p">)</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">Tdpp</span><span class="p">)</span>
    <span class="c1"># Calculate Fault Current</span>
    <span class="n">Ia</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">Eq</span><span class="p">)</span><span class="o">*</span><span class="n">t_c</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Ia</span><span class="p">)</span></div>

<span class="c1"># Define Synch. Machine Asymmetrical Current Calculator</span>
<div class="viewcode-block" id="synmach_Iasym"><a class="viewcode-back" href="../../api/electricpy.fault.synmach_Iasym.html#electricpy.fault.synmach_Iasym">[docs]</a><span class="k">def</span> <span class="nf">synmach_Iasym</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Eq</span><span class="p">,</span><span class="n">Xdpp</span><span class="p">,</span><span class="n">Xqpp</span><span class="p">,</span><span class="n">Ta</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">"""</span>
<span class="sd">    Synch. Machine Asymmetrical Fault Current Calc.</span>

<span class="sd">    Determines the asymmetrical fault current of a synchronous</span>
<span class="sd">    machine given the machine parameters, the internal voltage,</span>
<span class="sd">    and the time for which to calculate.</span>

<span class="sd">    .. math:: I_{asym}=\sqrt{2}\left|E_q\right|\frac{1}{2}</span>
<span class="sd">       \left(\frac{1}{X"_d}+\frac{1}{X"_q}\right)e^{\frac{-t}</span>
<span class="sd">       {T_a}}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t:          float</span>
<span class="sd">                Time at which to calculate the fault current</span>
<span class="sd">    Eq:         float</span>
<span class="sd">                The internal machine voltage in per-unit-volts</span>
<span class="sd">    Xdpp:       float</span>
<span class="sd">                The X"d (d-axis subtransient) reactance in</span>
<span class="sd">                per-unit-ohms</span>
<span class="sd">    Xqpp:       float</span>
<span class="sd">                The X"q (q-axis subtransient) reactance in</span>
<span class="sd">                per-unit-ohms</span>
<span class="sd">    Ta:         float</span>
<span class="sd">                Armature short-circuit (DC) time constant in seconds</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Iasym:      float</span>
<span class="sd">                Peak asymmetrical fault current in per-unit-amps</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate Time Constant Term</span>
    <span class="n">t_c</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">Xdpp</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">Xqpp</span>
    <span class="c1"># Calculate Asymmetrical Current</span>
    <span class="n">Iasym</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">Eq</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">t_c</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">Ta</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Iasym</span><span class="p">)</span></div>

<span class="c1"># Define Induction Machine Eigenvalue Calculator</span>
<div class="viewcode-block" id="indmacheigenvalues"><a class="viewcode-back" href="../../api/electricpy.fault.indmacheigenvalues.html#electricpy.fault.indmacheigenvalues">[docs]</a><span class="k">def</span> <span class="nf">indmacheigenvalues</span><span class="p">(</span><span class="n">Lr</span><span class="p">,</span><span class="n">Ls</span><span class="p">,</span><span class="n">Lm</span><span class="p">,</span><span class="n">Rr</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">wrf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Induction Machine Eigenvalue Calculator.</span>

<span class="sd">    Calculates the pertinent eigenvalues for an unloaded</span>
<span class="sd">    induction machine given a specific set of machine</span>
<span class="sd">    parameters.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Lr:         float</span>
<span class="sd">                Inductance of the Rotor (in Henrys).</span>
<span class="sd">    Ls:         float</span>
<span class="sd">                Inductance of the Stator (in Henrys).</span>
<span class="sd">    Lm:         float</span>
<span class="sd">                Inductance of the Magnetizing branch</span>
<span class="sd">                (in Henrys).</span>
<span class="sd">    Rr:         float</span>
<span class="sd">                Resistance of the Rotor (in Ohms).</span>
<span class="sd">    Rs:         float</span>
<span class="sd">                Resistance of the Stator (in Ohms).</span>
<span class="sd">    wrf:        float, optional</span>
<span class="sd">                Frequency (in radians/sec) of the rotor slip.</span>
<span class="sd">                default=0</span>
<span class="sd">    freq:       float, optional</span>
<span class="sd">                Base frequency of the system (in Hertz).</span>
<span class="sd">                default=60</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    lam1:       complex</span>
<span class="sd">                The First Eigenvalue</span>
<span class="sd">    lam2:       complex</span>
<span class="sd">                The Second Eigenvalue</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate Required Values</span>
    <span class="n">omega_e_base</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span>
    <span class="n">omega_rf</span> <span class="o">=</span> <span class="n">wrf</span>
    <span class="n">torque_s</span> <span class="o">=</span> <span class="n">Ls</span><span class="o">/</span><span class="p">(</span><span class="n">omega_e_base</span><span class="o">*</span><span class="n">Rs</span><span class="p">)</span>
    <span class="n">torque_r</span> <span class="o">=</span> <span class="n">Lr</span><span class="o">/</span><span class="p">(</span><span class="n">omega_e_base</span><span class="o">*</span><span class="n">Rr</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">torque_r</span> <span class="o">/</span> <span class="n">torque_s</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">Lm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">Ls</span><span class="o">*</span><span class="n">Lr</span><span class="p">)</span>
    <span class="n">omega_r</span> <span class="o">=</span> <span class="n">omega_e_base</span>
    <span class="c1"># Calculate k1</span>
    <span class="n">k1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span><span class="o">*</span><span class="n">torque_r</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">k1</span> <span class="o">+=</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="n">omega_r</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">omega_rf</span><span class="p">)</span>
    <span class="c1"># Calculate k2</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">phi</span><span class="o">*</span><span class="n">torque_r</span><span class="p">)</span>
    <span class="n">k2</span> <span class="o">*=</span> <span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">phi</span><span class="o">*</span><span class="n">alpha</span><span class="o">-</span><span class="p">(</span><span class="n">omega_r</span><span class="o">*</span><span class="n">phi</span><span class="o">*</span><span class="n">torque_r</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                 <span class="o">+</span><span class="mi">2</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">omega_r</span><span class="o">*</span><span class="n">phi</span><span class="o">*</span><span class="n">torque_r</span><span class="p">)</span>
    <span class="c1"># Evaluate Eigenvalues and Return</span>
    <span class="n">lam1</span> <span class="o">=</span> <span class="n">k1</span><span class="o">+</span><span class="n">k2</span>
    <span class="n">lam2</span> <span class="o">=</span> <span class="n">k1</span><span class="o">-</span><span class="n">k2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">lam1</span><span class="p">,</span><span class="n">lam2</span><span class="p">)</span></div>

<span class="c1"># Define IM 3-Phase SC Current Calculator</span>
<div class="viewcode-block" id="indmachphs3sc"><a class="viewcode-back" href="../../api/electricpy.fault.indmachphs3sc.html#electricpy.fault.indmachphs3sc">[docs]</a><span class="k">def</span> <span class="nf">indmachphs3sc</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Is0</span><span class="p">,</span><span class="n">Lr</span><span class="p">,</span><span class="n">Ls</span><span class="p">,</span><span class="n">Lm</span><span class="p">,</span><span class="n">Rr</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">wrf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Induction Machine 3-Phase SC Calculator.</span>

<span class="sd">    Determines the short-circuit current at a specified time for a three-phase</span>
<span class="sd">    fault on an unloaded induction machine.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t:          array_like</span>
<span class="sd">                The time at which to find the</span>
<span class="sd">                current, may be int, float, or</span>
<span class="sd">                numpy array.</span>
<span class="sd">    Is0:        complex</span>
<span class="sd">                The initial (t=0) current on</span>
<span class="sd">                the stator.</span>
<span class="sd">    Lr:         float</span>
<span class="sd">                Inductance of the Rotor (in Henrys).</span>
<span class="sd">    Ls:         float</span>
<span class="sd">                Inductance of the Stator (in Henrys).</span>
<span class="sd">    Lm:         float</span>
<span class="sd">                Inductance of the Magnetizing branch</span>
<span class="sd">                (in Henrys).</span>
<span class="sd">    Rr:         float</span>
<span class="sd">                Resistance of the Rotor (in Ohms).</span>
<span class="sd">    Rs:         float</span>
<span class="sd">                Resistance of the Stator (in Ohms).</span>
<span class="sd">    wrf:        float, optional</span>
<span class="sd">                Frequency (in radians/sec) of the rotor slip.</span>
<span class="sd">                default=0</span>
<span class="sd">    freq:       float, optional</span>
<span class="sd">                Base frequency of the system (in Hertz).</span>
<span class="sd">                default=60</span>
<span class="sd">    real:       bool, optional</span>
<span class="sd">                Control argument to force returned value</span>
<span class="sd">                to be real part only. default=True</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ias:        array_like</span>
<span class="sd">                Fault Current</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate Required Values</span>
    <span class="n">omega_r</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span>
    <span class="n">torque_s</span> <span class="o">=</span> <span class="n">Ls</span><span class="o">/</span><span class="p">(</span><span class="n">omega_r</span><span class="o">*</span><span class="n">Rs</span><span class="p">)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">Lm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">Ls</span><span class="o">*</span><span class="n">Lr</span><span class="p">)</span>
    <span class="c1"># Calculate Eigenvalues</span>
    <span class="n">lam1</span><span class="p">,</span> <span class="n">lam2</span> <span class="o">=</span> <span class="n">indmacheigenvalues</span><span class="p">(</span><span class="n">Lr</span><span class="p">,</span><span class="n">Ls</span><span class="p">,</span><span class="n">Lm</span><span class="p">,</span><span class="n">Rr</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">wrf</span><span class="p">,</span><span class="n">freq</span><span class="p">)</span>
    <span class="c1"># Calculate pIs0</span>
    <span class="n">pIs0</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">phi</span><span class="o">*</span><span class="n">torque_s</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">phi</span><span class="p">)</span><span class="o">/</span><span class="n">phi</span><span class="o">*</span><span class="n">omega_r</span><span class="p">)</span><span class="o">*</span><span class="n">Is0</span>
    <span class="c1"># Calculate Constants</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="p">(</span><span class="n">lam2</span><span class="o">*</span><span class="n">Is0</span><span class="o">-</span><span class="n">pIs0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">lam2</span><span class="o">-</span><span class="n">lam1</span><span class="p">)</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="p">(</span><span class="n">pIs0</span><span class="o">-</span><span class="n">lam1</span><span class="o">*</span><span class="n">Is0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">lam2</span><span class="o">-</span><span class="n">lam1</span><span class="p">)</span>
    <span class="c1"># Calculate ias and Return</span>
    <span class="n">ias</span> <span class="o">=</span> <span class="n">C1</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lam1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">C2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lam2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">real</span><span class="p">:</span>
        <span class="n">ias</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ias</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ias</span><span class="p">)</span></div>

<span class="c1"># Define IM Torque Calculation</span>
<div class="viewcode-block" id="indmachphs3torq"><a class="viewcode-back" href="../../api/electricpy.fault.indmachphs3torq.html#electricpy.fault.indmachphs3torq">[docs]</a><span class="k">def</span> <span class="nf">indmachphs3torq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Is0</span><span class="p">,</span><span class="n">Lr</span><span class="p">,</span><span class="n">Ls</span><span class="p">,</span><span class="n">Lm</span><span class="p">,</span><span class="n">Rr</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">wrf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Induction Machine 3-Phase Torque Calculator.</span>

<span class="sd">    Determines the torque exerted during a three-phase fault on an induction</span>
<span class="sd">    machine.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t:          array_like</span>
<span class="sd">                The time at which to find the</span>
<span class="sd">                current, may be int, float, or</span>
<span class="sd">                numpy array.</span>
<span class="sd">    Is0:        complex</span>
<span class="sd">                The initial (t=0) current on</span>
<span class="sd">                the stator.</span>
<span class="sd">    Lr:         float</span>
<span class="sd">                Inductance of the Rotor (in Henrys).</span>
<span class="sd">    Ls:         float</span>
<span class="sd">                Inductance of the Stator (in Henrys).</span>
<span class="sd">    Lm:         float</span>
<span class="sd">                Inductance of the Magnetizing branch</span>
<span class="sd">                (in Henrys).</span>
<span class="sd">    Rr:         float</span>
<span class="sd">                Resistance of the Rotor (in Ohms).</span>
<span class="sd">    Rs:         float</span>
<span class="sd">                Resistance of the Stator (in Ohms).</span>
<span class="sd">    p:          int</span>
<span class="sd">                Number of electrical poles.</span>
<span class="sd">    wrf:        float, optional</span>
<span class="sd">                Frequency (in radians/sec) of the rotor slip.</span>
<span class="sd">                default=0</span>
<span class="sd">    freq:       float, optional</span>
<span class="sd">                Base frequency of the system (in Hertz).</span>
<span class="sd">                default=60</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tem:        array_like</span>
<span class="sd">                Induction machine torque in N*m</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate Required Values</span>
    <span class="n">omega_r</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span>
    <span class="n">torque_s</span> <span class="o">=</span> <span class="n">Ls</span><span class="o">/</span><span class="p">(</span><span class="n">omega_r</span><span class="o">*</span><span class="n">Rs</span><span class="p">)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">Lm</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">Ls</span><span class="o">*</span><span class="n">Lr</span><span class="p">)</span>
    <span class="c1"># Calculate Eigenvalues</span>
    <span class="n">lam1</span><span class="p">,</span> <span class="n">lam2</span> <span class="o">=</span> <span class="n">indmacheigenvalues</span><span class="p">(</span><span class="n">Lr</span><span class="p">,</span><span class="n">Ls</span><span class="p">,</span><span class="n">Lm</span><span class="p">,</span><span class="n">Rr</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">wrf</span><span class="p">,</span><span class="n">freq</span><span class="p">)</span>
    <span class="c1"># Calculate pIs0</span>
    <span class="n">pIs0</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">phi</span><span class="o">*</span><span class="n">torque_s</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">phi</span><span class="p">)</span><span class="o">/</span><span class="n">phi</span><span class="o">*</span><span class="n">omega_r</span><span class="p">)</span><span class="o">*</span><span class="n">Is0</span>
    <span class="c1"># Calculate Constants</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="p">(</span><span class="n">lam2</span><span class="o">*</span><span class="n">Is0</span><span class="o">-</span><span class="n">pIs0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">lam2</span><span class="o">-</span><span class="n">lam1</span><span class="p">)</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="p">(</span><span class="n">pIs0</span><span class="o">-</span><span class="n">lam1</span><span class="o">*</span><span class="n">Is0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">lam2</span><span class="o">-</span><span class="n">lam1</span><span class="p">)</span>
    <span class="c1"># Calculate ias and Return</span>
    <span class="n">idqs</span> <span class="o">=</span> <span class="n">C1</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lam1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">C2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lam2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">idqr</span> <span class="o">=</span> <span class="n">C2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lam1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">C1</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lam2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="c1"># Calculate Lambda</span>
    <span class="n">lamdqr</span> <span class="o">=</span> <span class="n">Lm</span><span class="o">*</span><span class="n">idqs</span><span class="o">+</span><span class="n">Lr</span><span class="o">*</span><span class="n">idqr</span>
    <span class="c1"># Calculate Torque</span>
    <span class="n">Tem</span> <span class="o">=</span> <span class="n">Lm</span><span class="o">/</span><span class="n">Lr</span> <span class="o">*</span> <span class="p">(</span><span class="n">lamdqr</span><span class="o">.</span><span class="n">real</span><span class="o">*</span><span class="n">idqs</span><span class="o">.</span><span class="n">imag</span> <span class="o">-</span> <span class="n">lamdqr</span><span class="o">.</span><span class="n">imag</span><span class="o">*</span><span class="n">idqs</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Tem</span><span class="p">)</span></div>

<span class="c1"># Define Complete Sync. Mach. Fault Current Function</span>
<div class="viewcode-block" id="synmach_ifault"><a class="viewcode-back" href="../../api/electricpy.fault.synmach_ifault.html#electricpy.fault.synmach_ifault">[docs]</a><span class="k">def</span> <span class="nf">synmach_ifault</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Ea</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">Xd</span><span class="p">,</span><span class="n">Xdp</span><span class="p">,</span><span class="n">Xdpp</span><span class="p">,</span><span class="n">Xqpp</span><span class="p">,</span><span class="n">Tdp</span><span class="p">,</span><span class="n">Tdpp</span><span class="p">,</span><span class="n">Ta</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="c1"># noqa: D401   "Synchronous" is intentional descriptor</span>
    <span class="sd">"""</span>
<span class="sd">    Synchronous Machine Fault Current Calculator.</span>

<span class="sd">    Given machine parameters, fault inception angle, and time at</span>
<span class="sd">    which to calculate fault current, this function will identify</span>
<span class="sd">    the complete (symmetrical, asymmetrical, and double frequency)</span>
<span class="sd">    fault current.</span>

<span class="sd">    .. image:: /static/synmach_ifault_formula.png</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    t:          float</span>
<span class="sd">                Time at which to calculate the fault current</span>
<span class="sd">    Eq:         float</span>
<span class="sd">                The internal machine voltage in per-unit-volts</span>
<span class="sd">    alpha:      float</span>
<span class="sd">                Fault inception angle (in degrees)</span>
<span class="sd">    Xd:         float</span>
<span class="sd">                The Xd (d-axis) reactance in per-unit-ohms</span>
<span class="sd">    Xdp:        float</span>
<span class="sd">                The X"d (d-axis transient) reactance in</span>
<span class="sd">                per-unit-ohms</span>
<span class="sd">    Xdpp:       float</span>
<span class="sd">                The X"d (d-axis subtransient) reactance in</span>
<span class="sd">                per-unit-ohms</span>
<span class="sd">    Xqpp:       float</span>
<span class="sd">                The X"q (q-axis subtransient) reactance in</span>
<span class="sd">                per-unit-ohms</span>
<span class="sd">    Tdp:        float</span>
<span class="sd">                The T'd (d-axis transient) time constant of the</span>
<span class="sd">                machine in seconds</span>
<span class="sd">    Tdpp:       float</span>
<span class="sd">                The T"d (d-axis subtransient) time constant of</span>
<span class="sd">                the machine in seconds</span>
<span class="sd">    Ta:         float</span>
<span class="sd">                Armature short-circuit (DC) time constant in seconds</span>
<span class="sd">    freq:       float, optional</span>
<span class="sd">                System (electrical) frequency (in degrees),</span>
<span class="sd">                default=60</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ias:        float</span>
<span class="sd">                Synchronous machine fault current (symmetrical,</span>
<span class="sd">                asymmetrical, and double frequency component) in</span>
<span class="sd">                amps</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate we Component</span>
    <span class="n">we</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span>
    <span class="c1"># Condition Inputs</span>
    <span class="n">Ea</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Ea</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="c1"># Define Constant Term</span>
    <span class="n">const</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Ea</span>
    <span class="k">if</span> <span class="n">Xqpp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">Xqpp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">asym</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Xdpp</span><span class="o">+</span><span class="n">val</span><span class="p">)</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">Ta</span><span class="p">)</span>
    <span class="c1"># Define Symmetrical Portion</span>
    <span class="n">isym</span> <span class="o">=</span> <span class="n">const</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Xd</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Xdp</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">Xd</span><span class="p">)</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">Tdp</span><span class="p">)</span>
               <span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Xdpp</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">Xdp</span><span class="p">)</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">Tdpp</span><span class="p">))</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">we</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">alpha</span><span class="p">)</span>
    <span class="c1"># Define Asymmetrical Portion</span>
    <span class="n">iasym</span> <span class="o">=</span> <span class="n">const</span><span class="o">*</span><span class="n">asym</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="c1"># Define Double Frequency Term</span>
    <span class="n">idbl</span> <span class="o">=</span> <span class="n">const</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">asym</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">we</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">alpha</span><span class="p">)</span>
    <span class="c1"># Compose Complet Current Value</span>
    <span class="n">ias</span> <span class="o">=</span> <span class="n">isym</span> <span class="o">-</span> <span class="n">iasym</span> <span class="o">-</span> <span class="n">idbl</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ias</span><span class="p">)</span></div>



<span class="c1"># END OF FILE</span>
</pre></div>

          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2022, Joe Stanley.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>